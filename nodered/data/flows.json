[
    {
        "disabled": false,
        "env": [],
        "id": "a0a86b2bcc8e6558",
        "info": "",
        "label": "home",
        "type": "tab"
    },
    {
        "disabled": false,
        "env": [],
        "id": "927060cd46690ff4",
        "info": "",
        "label": "test",
        "type": "tab"
    },
    {
        "category": "",
        "color": "#DDAA99",
        "env": [
            {
                "name": "name",
                "type": "str",
                "value": ""
            }
        ],
        "id": "492ba385940b0a9c",
        "in": [
            {
                "wires": [
                    {
                        "id": "e34ac6e461647328"
                    }
                ],
                "x": 60,
                "y": 60
            }
        ],
        "info": "",
        "meta": {},
        "name": "dimmer in",
        "out": [
            {
                "wires": [
                    {
                        "id": "b2ce07f13984236e",
                        "port": 0
                    }
                ],
                "x": 940,
                "y": 60
            }
        ],
        "type": "subflow"
    },
    {
        "category": "",
        "color": "#DDAA99",
        "env": [
            {
                "name": "name",
                "type": "str",
                "value": ""
            }
        ],
        "id": "4c0cd1386899de21",
        "in": [
            {
                "wires": [
                    {
                        "id": "293e9abc4b0a8ae2"
                    }
                ],
                "x": 60,
                "y": 60
            }
        ],
        "info": "",
        "meta": {},
        "name": "dimmer out",
        "out": [
            {
                "wires": [
                    {
                        "id": "293e9abc4b0a8ae2",
                        "port": 0
                    }
                ],
                "x": 340,
                "y": 60
            }
        ],
        "type": "subflow"
    },
    {
        "category": "",
        "color": "#DDAA99",
        "env": [
            {
                "name": "name",
                "type": "str",
                "value": ""
            },
            {
                "name": "button",
                "type": "num",
                "value": ""
            }
        ],
        "id": "cbef3ce630f61ff7",
        "in": [
            {
                "wires": [
                    {
                        "id": "6ad05ebfdf618fc3"
                    }
                ],
                "x": 60,
                "y": 80
            }
        ],
        "info": "",
        "meta": {},
        "name": "buttons",
        "out": [
            {
                "wires": [
                    {
                        "id": "840625cf049a82f7",
                        "port": 0
                    }
                ],
                "x": 1240,
                "y": 80
            }
        ],
        "type": "subflow"
    },
    {
        "category": "",
        "color": "#DDAA99",
        "env": [
            {
                "name": "timeout",
                "type": "num",
                "value": "300"
            },
            {
                "name": "step",
                "type": "num",
                "value": "1"
            },
            {
                "name": "min",
                "type": "num",
                "value": "10"
            }
        ],
        "id": "2d585252458c7615",
        "in": [
            {
                "wires": [
                    {
                        "id": "5f258bcaab943cf3"
                    },
                    {
                        "id": "9ac8057d58a83241"
                    }
                ],
                "x": 60,
                "y": 120
            }
        ],
        "info": "",
        "meta": {},
        "name": "processing",
        "out": [
            {
                "wires": [
                    {
                        "id": "891f2718db62c087",
                        "port": 0
                    },
                    {
                        "id": "f125214e2289d8dc",
                        "port": 0
                    }
                ],
                "x": 820,
                "y": 240
            }
        ],
        "type": "subflow"
    },
    {
        "category": "",
        "color": "#DDAA99",
        "env": [
            {
                "name": "name",
                "type": "str",
                "value": ""
            },
            {
                "name": "relay",
                "type": "num",
                "value": ""
            }
        ],
        "id": "79a320b1aad5b1c6",
        "in": [
            {
                "wires": [
                    {
                        "id": "12e1f1ecacab1fdb"
                    }
                ],
                "x": 60,
                "y": 60
            }
        ],
        "info": "",
        "meta": {},
        "name": "rgbw in",
        "out": [
            {
                "wires": [
                    {
                        "id": "a5065b3bda883d72",
                        "port": 0
                    }
                ],
                "x": 980,
                "y": 60
            }
        ],
        "type": "subflow"
    },
    {
        "category": "",
        "color": "#C0DEED",
        "env": [],
        "icon": "font-awesome/fa-mobile-phone",
        "id": "257349cc625bde40",
        "in": [
            {
                "wires": [
                    {
                        "id": "87105726ae6f51c3"
                    }
                ],
                "x": 60,
                "y": 140
            }
        ],
        "info": "",
        "meta": {},
        "name": "web UI | DT",
        "out": [
            {
                "wires": [
                    {
                        "id": "83f56f65f7624daf",
                        "port": 0
                    },
                    {
                        "id": "e5d2f4247d2c00c0",
                        "port": 0
                    }
                ],
                "x": 640,
                "y": 80
            }
        ],
        "type": "subflow"
    },
    {
        "category": "",
        "color": "#C0DEED",
        "env": [],
        "icon": "font-awesome/fa-mobile-phone",
        "id": "2e41c0e60bcda4c7",
        "in": [
            {
                "wires": [
                    {
                        "id": "8e3c0c5bbcfab58e"
                    }
                ],
                "x": 60,
                "y": 140
            }
        ],
        "info": "",
        "meta": {},
        "name": "web UI | SL",
        "out": [
            {
                "wires": [
                    {
                        "id": "7437a1d4bb3fa04d",
                        "port": 0
                    },
                    {
                        "id": "644b228c12cab9c9",
                        "port": 0
                    }
                ],
                "x": 640,
                "y": 80
            }
        ],
        "type": "subflow"
    },
    {
        "category": "",
        "color": "#C0DEED",
        "env": [],
        "icon": "font-awesome/fa-mobile-phone",
        "id": "2f4e178c5ad4e48d",
        "in": [
            {
                "wires": [
                    {
                        "id": "25f52c3ccb5bd276"
                    }
                ],
                "x": 60,
                "y": 140
            }
        ],
        "info": "",
        "meta": {},
        "name": "web UI | Amb",
        "out": [
            {
                "wires": [
                    {
                        "id": "2226cf3795c65d69",
                        "port": 0
                    }
                ],
                "x": 540,
                "y": 100
            },
            {
                "wires": [
                    {
                        "id": "9cf747c3d848afdc",
                        "port": 0
                    }
                ],
                "x": 540,
                "y": 140
            }
        ],
        "type": "subflow"
    },
    {
        "category": "",
        "color": "#C0DEED",
        "env": [],
        "icon": "font-awesome/fa-mobile-phone",
        "id": "5774065fbd82585f",
        "in": [
            {
                "wires": [
                    {
                        "id": "bb8e6dbe32cb2930"
                    }
                ],
                "x": 60,
                "y": 140
            }
        ],
        "info": "",
        "meta": {},
        "name": "web UI | Int",
        "out": [
            {
                "wires": [
                    {
                        "id": "5e13193493ef2c8a",
                        "port": 0
                    }
                ],
                "x": 540,
                "y": 100
            },
            {
                "wires": [
                    {
                        "id": "8a338a12265783b9",
                        "port": 0
                    }
                ],
                "x": 540,
                "y": 140
            }
        ],
        "type": "subflow"
    },
    {
        "category": "",
        "color": "#C0DEED",
        "env": [],
        "icon": "font-awesome/fa-mobile-phone",
        "id": "d21607ed4bd9c3e2",
        "in": [
            {
                "wires": [
                    {
                        "id": "77cd0b5e15e80ca5"
                    }
                ],
                "x": 60,
                "y": 140
            }
        ],
        "info": "",
        "meta": {},
        "name": "web UI | Bed",
        "out": [
            {
                "wires": [
                    {
                        "id": "1c96a615e0e16a2a",
                        "port": 0
                    },
                    {
                        "id": "a9a824ef599a2398",
                        "port": 0
                    }
                ],
                "x": 640,
                "y": 80
            }
        ],
        "type": "subflow"
    },
    {
        "category": "",
        "color": "#C0DEED",
        "env": [],
        "icon": "font-awesome/fa-mobile-phone",
        "id": "fbc53d40d3ad022e",
        "in": [
            {
                "wires": [
                    {
                        "id": "e4aee0817bc0e922"
                    }
                ],
                "x": 60,
                "y": 140
            }
        ],
        "info": "",
        "meta": {},
        "name": "web UI | WC",
        "out": [
            {
                "wires": [
                    {
                        "id": "f1f1638e07590e44",
                        "port": 0
                    },
                    {
                        "id": "306e40ce157269d1",
                        "port": 0
                    }
                ],
                "x": 620,
                "y": 80
            }
        ],
        "type": "subflow"
    },
    {
        "category": "",
        "color": "#C0DEED",
        "env": [],
        "icon": "font-awesome/fa-mobile-phone",
        "id": "cc0cff40c0be42c3",
        "in": [
            {
                "wires": [
                    {
                        "id": "41396108be566aa7"
                    }
                ],
                "x": 60,
                "y": 140
            }
        ],
        "info": "",
        "meta": {},
        "name": "web UI | Bath",
        "out": [
            {
                "wires": [
                    {
                        "id": "76ba3f16808db218",
                        "port": 0
                    },
                    {
                        "id": "29b930154dd0844b",
                        "port": 0
                    }
                ],
                "x": 620,
                "y": 80
            }
        ],
        "type": "subflow"
    },
    {
        "category": "",
        "color": "#C0DEED",
        "env": [],
        "icon": "font-awesome/fa-mobile-phone",
        "id": "56930ca583a30724",
        "in": [
            {
                "wires": [
                    {
                        "id": "03a5ec83b7d528fe"
                    }
                ],
                "x": 60,
                "y": 140
            }
        ],
        "info": "",
        "meta": {},
        "name": "web UI | Ch",
        "out": [
            {
                "wires": [
                    {
                        "id": "6ce2745bad15b2e7",
                        "port": 0
                    },
                    {
                        "id": "c16a2a3d81b55902",
                        "port": 0
                    }
                ],
                "x": 640,
                "y": 80
            }
        ],
        "type": "subflow"
    },
    {
        "h": 162,
        "id": "70e28aaa371d1526",
        "name": "Kitchen: Dinning table",
        "nodes": [
            "a7f2a6506d759447",
            "2df5cf650d34edcc",
            "afe24f902e571f2e",
            "715338d3f4fb3ac7",
            "827e07c098b505e0",
            "4daba07e960c2eeb",
            "c7d95af3ca07ce4b",
            "aee391f4442804ee"
        ],
        "style": {
            "label": true
        },
        "type": "group",
        "w": 992,
        "x": 14,
        "y": 39,
        "z": "a0a86b2bcc8e6558"
    },
    {
        "h": 162,
        "id": "f55d2c7b19e0ede8",
        "name": "Living room: Sofa lamp",
        "nodes": [
            "1ede78aab2135743",
            "44960675995b0228",
            "b6923abe8da22af2",
            "8650945b0b55de40",
            "d6ce41d151adbb27",
            "68903cc1339976f2",
            "8ca38bb40b5b141a",
            "1c05965e272d4559"
        ],
        "style": {
            "label": true
        },
        "type": "group",
        "w": 992,
        "x": 14,
        "y": 219,
        "z": "a0a86b2bcc8e6558"
    },
    {
        "h": 162,
        "id": "e41b34ecb4de2eb1",
        "name": "Living room: Ambient light",
        "nodes": [
            "897f1c25eac5ef6b",
            "adea4321f7d65fbc",
            "0f6e5e05a384ccbc",
            "c43d88f0a6cf9ecb",
            "4fc074817167e9f9",
            "9028556566f2cb37",
            "9c001ea7d54b0057",
            "03a7df41c74aca51",
            "dcd2cc4da81c2d2b",
            "7a1427a0b4711d76"
        ],
        "style": {
            "label": true
        },
        "type": "group",
        "w": 1072,
        "x": 14,
        "y": 399,
        "z": "a0a86b2bcc8e6558"
    },
    {
        "h": 162,
        "id": "7e6a568d010b4632",
        "name": "Living room: Integrated lights",
        "nodes": [
            "c6b94d40a07b7571",
            "913682f3b59ac52b",
            "475f75c4c2eb10d8",
            "f10ee5104e707864",
            "773441761db531ea",
            "1e5fd71a8ed698bf",
            "b4b181ef4be0a915",
            "3884ac35ae472890",
            "e52a4e7bc08c18ca",
            "e77701baef16ec49"
        ],
        "style": {
            "label": true
        },
        "type": "group",
        "w": 1072,
        "x": 14,
        "y": 579,
        "z": "a0a86b2bcc8e6558"
    },
    {
        "h": 162,
        "id": "8b798a26c7d6fc01",
        "name": "Bedroom",
        "nodes": [
            "7d367520dbc9ad84",
            "d793a97038cfc19d",
            "f3d5015e09634c2c",
            "4eb63e5365042d67",
            "a13f24cb6365754e",
            "cb54ed4d7ff08f9a",
            "45203cfbac0c2608",
            "ec652bed47668666"
        ],
        "style": {
            "label": true
        },
        "type": "group",
        "w": 992,
        "x": 14,
        "y": 759,
        "z": "a0a86b2bcc8e6558"
    },
    {
        "h": 202,
        "id": "593259f5b14bdad3",
        "name": "WC & Bathroom",
        "nodes": [
            "e6f34c6d41f62cb4",
            "72d12326ac27d3d0",
            "5b0a167104357373",
            "877b6b22f10fe625",
            "3e90cd523b63f9bf",
            "1a28bdf18ec8e12e",
            "0ffde8114552b859",
            "7cce2dea7ab2e57d",
            "da34552cedea09aa",
            "0ed030613fccdd05"
        ],
        "style": {
            "label": true
        },
        "type": "group",
        "w": 992,
        "x": 14,
        "y": 939,
        "z": "a0a86b2bcc8e6558"
    },
    {
        "h": 82,
        "id": "475b29c6fe19cc2f",
        "name": "Kitchen: Cabinet",
        "nodes": [
            "bd622d957a6649e7",
            "0e715d3cd4295d30",
            "3ad3acf5882144a3",
            "44acc098596467ab",
            "690fa293b8ad6c11"
        ],
        "style": {
            "label": true
        },
        "type": "group",
        "w": 432,
        "x": 1114,
        "y": 659,
        "z": "a0a86b2bcc8e6558"
    },
    {
        "h": 142,
        "id": "c670bbc601d06f66",
        "name": "Children",
        "nodes": [
            "ac21c02cac1dfbb9",
            "6945fa7671640154",
            "7e353c865aeadf04",
            "b6e75cf8831334d2",
            "99f02fbd5222c74c"
        ],
        "style": {
            "label": true
        },
        "type": "group",
        "w": 652,
        "x": 1034,
        "y": 759,
        "z": "a0a86b2bcc8e6558"
    },
    {
        "autoConnect": true,
        "autoUnsubscribe": true,
        "birthMsg": {},
        "birthPayload": "",
        "birthQos": "0",
        "birthRetain": "false",
        "birthTopic": "",
        "broker": "mosquitto",
        "cleansession": true,
        "clientid": "",
        "closeMsg": {},
        "closePayload": "",
        "closeQos": "0",
        "closeRetain": "false",
        "closeTopic": "",
        "id": "872ce2a0d0bada26",
        "keepalive": "60",
        "name": "",
        "port": "1883",
        "protocolVersion": "4",
        "sessionExpiry": "",
        "type": "mqtt-broker",
        "userProps": "",
        "usetls": false,
        "willMsg": {},
        "willPayload": "",
        "willQos": "0",
        "willRetain": "false",
        "willTopic": ""
    },
    {
        "acceptsClientConfig": [
            "ui-notification",
            "ui-control"
        ],
        "id": "e50461ed35e39340",
        "includeClientData": true,
        "name": "My Dashboard",
        "navigationStyle": "default",
        "path": "/dashboard",
        "showPathInSidebar": false,
        "type": "ui-base"
    },
    {
        "colors": {
            "bgPage": "#eeeeee",
            "groupBg": "#ffffff",
            "groupOutline": "#cccccc",
            "primary": "#0094CE",
            "surface": "#ffffff"
        },
        "id": "66b52bbeabf9de9f",
        "name": "Default Theme",
        "sizes": {
            "groupBorderRadius": "4px",
            "groupGap": "12px",
            "pagePadding": "12px",
            "widgetGap": "12px"
        },
        "type": "ui-theme"
    },
    {
        "className": "",
        "disabled": false,
        "icon": "home",
        "id": "c59aa56799b651c9",
        "layout": "grid",
        "name": "Home",
        "order": -1,
        "path": "/home",
        "theme": "66b52bbeabf9de9f",
        "type": "ui-page",
        "ui": "e50461ed35e39340",
        "visible": "true"
    },
    {
        "className": "",
        "disabled": false,
        "height": "1",
        "id": "4eaae3cca0908442",
        "name": "Kitchen: Dinning table",
        "order": 2,
        "page": "c59aa56799b651c9",
        "showTitle": true,
        "type": "ui-group",
        "visible": "true",
        "width": "6"
    },
    {
        "className": "",
        "disabled": false,
        "height": "1",
        "id": "6fdff81ac0800b78",
        "name": "Living room: Sofa",
        "order": 5,
        "page": "c59aa56799b651c9",
        "showTitle": true,
        "type": "ui-group",
        "visible": "true",
        "width": "6"
    },
    {
        "className": "",
        "disabled": false,
        "height": "1",
        "id": "0e4aa815f39f2e96",
        "name": "Living room: Ambient",
        "order": 3,
        "page": "c59aa56799b651c9",
        "showTitle": true,
        "type": "ui-group",
        "visible": "true",
        "width": "6"
    },
    {
        "className": "",
        "disabled": false,
        "height": "1",
        "id": "c153757bd2ce4c9e",
        "name": "Living room: Integrated",
        "order": 4,
        "page": "c59aa56799b651c9",
        "showTitle": true,
        "type": "ui-group",
        "visible": "true",
        "width": "6"
    },
    {
        "className": "",
        "disabled": false,
        "height": "1",
        "id": "7249de5d656a05c1",
        "name": "Bedroom",
        "order": 6,
        "page": "c59aa56799b651c9",
        "showTitle": true,
        "type": "ui-group",
        "visible": "true",
        "width": "6",
        "z": "d21607ed4bd9c3e2"
    },
    {
        "className": "",
        "disabled": false,
        "height": "1",
        "id": "c54dde3886a22377",
        "name": "WC",
        "order": 8,
        "page": "c59aa56799b651c9",
        "showTitle": true,
        "type": "ui-group",
        "visible": "true",
        "width": "6",
        "z": "fbc53d40d3ad022e"
    },
    {
        "className": "",
        "disabled": false,
        "height": "1",
        "id": "86b9d12ad87eaa24",
        "name": "Bathroom",
        "order": 9,
        "page": "c59aa56799b651c9",
        "showTitle": true,
        "type": "ui-group",
        "visible": "true",
        "width": "6",
        "z": "cc0cff40c0be42c3"
    },
    {
        "className": "",
        "disabled": false,
        "height": "1",
        "id": "535b1c0c6989df4e",
        "name": "Kitchen: Cabinet",
        "order": 1,
        "page": "c59aa56799b651c9",
        "showTitle": true,
        "type": "ui-group",
        "visible": "true",
        "width": "6"
    },
    {
        "className": "",
        "disabled": "false",
        "height": "1",
        "id": "51c5f0b66acb1db3",
        "name": "Children",
        "order": 7,
        "page": "c59aa56799b651c9",
        "showTitle": true,
        "type": "ui-group",
        "visible": "true",
        "width": "6",
        "z": "56930ca583a30724"
    },
    {
        "addchar": "",
        "bin": "false",
        "cts": "none",
        "databits": "8",
        "dsr": "none",
        "dtr": "none",
        "id": "4acc30c6d5b7fd08",
        "name": "esp32s3",
        "newline": "\\n",
        "out": "char",
        "parity": "none",
        "responsetimeout": "10000",
        "rts": "none",
        "serialbaud": "57600",
        "serialport": "/dev/ttyACM0",
        "stopbits": "1",
        "type": "serial-port",
        "waitfor": ""
    },
    {
        "baseapiurl": "",
        "bothost": "",
        "botname": "MQTT Home",
        "botpath": "",
        "certificate": "",
        "chatids": "",
        "id": "739495fdd028c669",
        "localbothost": "0.0.0.0",
        "localbotport": "8443",
        "pollinterval": "300",
        "privatekey": "",
        "publicbotport": "8443",
        "sockshost": "",
        "sockspassword": "",
        "socksport": "6667",
        "socksprotocol": "socks5",
        "socksusername": "anonymous",
        "sslterminated": false,
        "testenvironment": false,
        "type": "telegram bot",
        "updatemode": "none",
        "usernames": "",
        "useselfsignedcertificate": false,
        "usesocks": false,
        "verboselogging": false
    },
    {
        "finalize": "",
        "func": "const name = `shellies/${env.get('name')}`;\n\nif (msg.topic.startsWith(name)) {\n  return msg;\n}",
        "id": "e34ac6e461647328",
        "initialize": "",
        "libs": [],
        "name": "filter | by name",
        "noerr": 0,
        "outputs": 1,
        "timeout": 0,
        "type": "function",
        "wires": [
            [
                "b9774548453d2767"
            ]
        ],
        "x": 200,
        "y": 60,
        "z": "492ba385940b0a9c"
    },
    {
        "finalize": "",
        "func": "let state = flow.get('state') || {};\n\nstate = {\n  ...state,\n  ...msg.payload\n};\n\nflow.set('state', state);\n\nreturn {\n  type: 'state',\n  payload: state\n};",
        "id": "2684f85fe3ec50f9",
        "initialize": "",
        "libs": [],
        "name": "manage state",
        "noerr": 0,
        "outputs": 1,
        "timeout": 0,
        "type": "function",
        "wires": [
            [
                "b2ce07f13984236e"
            ]
        ],
        "x": 620,
        "y": 60,
        "z": "492ba385940b0a9c"
    },
    {
        "finalize": "",
        "func": "if (msg.topic.endsWith('/light/0/status')) {\n  const { ison, brightness } = msg.payload;\n  return {\n    payload: {\n      on: ison,\n      brightness\n    }\n  };\n}\n\nif (msg.topic.endsWith('/temperature')) {\n  return {\n    payload: {\n      temperature: msg.payload\n    }\n  };\n}\n\nif (msg.topic.endsWith('/overtemperature')) {\n  return {\n    payload: {\n      overtemperature: msg.payload !== 0\n    }\n  };\n}\n\nif (msg.topic.endsWith('/overpower')) {\n  return {\n    payload: {\n      overpower: msg.payload !== 0\n    }\n  };\n}\n",
        "id": "b9774548453d2767",
        "initialize": "",
        "libs": [],
        "name": "normalize payload",
        "noerr": 0,
        "outputs": 1,
        "timeout": 0,
        "type": "function",
        "wires": [
            [
                "2684f85fe3ec50f9"
            ]
        ],
        "x": 410,
        "y": 60,
        "z": "492ba385940b0a9c"
    },
    {
        "func": "rbe",
        "gap": "",
        "id": "b2ce07f13984236e",
        "inout": "out",
        "name": "on change",
        "property": "payload",
        "septopics": false,
        "start": "",
        "topi": "topic",
        "type": "rbe",
        "wires": [
            []
        ],
        "x": 810,
        "y": 60,
        "z": "492ba385940b0a9c"
    },
    {
        "finalize": "",
        "func": "const topic = `shellies/${env.get('name')}/light/0/set`;\nreturn {\n  topic,\n  payload: msg.payload\n};",
        "id": "293e9abc4b0a8ae2",
        "initialize": "",
        "libs": [],
        "name": "change payload",
        "noerr": 0,
        "outputs": 1,
        "timeout": 0,
        "type": "function",
        "wires": [
            []
        ],
        "x": 200,
        "y": 60,
        "z": "4c0cd1386899de21"
    },
    {
        "finalize": "",
        "func": "const name = `shellies/${env.get('name')}`;\n\nif (msg.topic.startsWith(name)) {\n  return msg;\n}\n",
        "id": "6ad05ebfdf618fc3",
        "initialize": "",
        "libs": [],
        "name": "filter | by name",
        "noerr": 0,
        "outputs": 1,
        "timeout": 0,
        "type": "function",
        "wires": [
            [
                "4ce3dc7b2d543dec"
            ]
        ],
        "x": 200,
        "y": 80,
        "z": "cbef3ce630f61ff7"
    },
    {
        "finalize": "",
        "func": "const { method } = msg.payload;\n\nif (method === 'NotifyEvent') {\n  return msg;\n}\n\nnode.warn('buttons in: unexpected method ' + method);\nnode.warn(msg.payload);",
        "id": "76e1efb068f43e47",
        "initialize": "",
        "libs": [],
        "name": "filter | method = NotifyEvent",
        "noerr": 0,
        "outputs": 1,
        "timeout": 0,
        "type": "function",
        "wires": [
            [
                "65a7bcd18395c494"
            ]
        ],
        "x": 640,
        "y": 80,
        "z": "cbef3ce630f61ff7"
    },
    {
        "finalize": "",
        "func": "const { params: { events } } = msg.payload;\n\nfor (const ev of events) {\n  const { id, event } = ev;\n\n  node.send({\n    type: 'change',\n    payload: {\n      input: id,\n      event\n    }\n  });\n}\n",
        "id": "65a7bcd18395c494",
        "initialize": "",
        "libs": [],
        "name": "normalize payload",
        "noerr": 0,
        "outputs": 1,
        "timeout": 0,
        "type": "function",
        "wires": [
            [
                "840625cf049a82f7"
            ]
        ],
        "x": 890,
        "y": 80,
        "z": "cbef3ce630f61ff7"
    },
    {
        "finalize": "",
        "func": "if (msg.topic.endsWith('/events/rpc')) {\n  return msg;\n}",
        "id": "4ce3dc7b2d543dec",
        "initialize": "",
        "libs": [],
        "name": "filter | only rpc",
        "noerr": 0,
        "outputs": 1,
        "timeout": 0,
        "type": "function",
        "wires": [
            [
                "76e1efb068f43e47"
            ]
        ],
        "x": 400,
        "y": 80,
        "z": "cbef3ce630f61ff7"
    },
    {
        "finalize": "",
        "func": "const buttonId = env.get('button');\nconst { input } = msg.payload;\n\nif (input === buttonId) {\n  return msg;\n}",
        "id": "840625cf049a82f7",
        "initialize": "",
        "libs": [],
        "name": "filter | by button",
        "noerr": 0,
        "outputs": 1,
        "timeout": 0,
        "type": "function",
        "wires": [
            []
        ],
        "x": 1100,
        "y": 80,
        "z": "cbef3ce630f61ff7"
    },
    {
        "finalize": "",
        "func": "if (msg.payload.event === 'single_push') {\n  return {\n    payload: {\n      turn: 'toggle'\n    }\n  };\n}",
        "id": "891f2718db62c087",
        "initialize": "",
        "libs": [],
        "name": "filter | single_push",
        "noerr": 0,
        "outputs": 1,
        "timeout": 0,
        "type": "function",
        "wires": [
            []
        ],
        "x": 490,
        "y": 240,
        "z": "2d585252458c7615"
    },
    {
        "finalize": "",
        "func": "if (msg.payload.event === 'long_push') {\n  return msg;\n}",
        "id": "70f1720456e3896f",
        "initialize": "",
        "libs": [],
        "name": "filter | long_push",
        "noerr": 0,
        "outputs": 1,
        "timeout": 0,
        "type": "function",
        "wires": [
            [
                "f125214e2289d8dc"
            ]
        ],
        "x": 480,
        "y": 300,
        "z": "2d585252458c7615"
    },
    {
        "finalize": "",
        "func": "if (msg.payload.event === 'btn_up') {\n  return msg;\n}",
        "id": "9355e0933b161646",
        "initialize": "",
        "libs": [],
        "name": "filter | btn_up",
        "noerr": 0,
        "outputs": 1,
        "timeout": 0,
        "type": "function",
        "wires": [
            [
                "362aab73dfafe062"
            ]
        ],
        "x": 470,
        "y": 180,
        "z": "2d585252458c7615"
    },
    {
        "finalize": "",
        "func": "const step = env.get('step');\nconst timeout = env.get('timeout');\nconst min = env.get('min');\n\nlet transitionUp = flow.get('transitionUp') || false;\ntransitionUp = !transitionUp;\nflow.set('transitionUp', transitionUp);\n\nlet transitionBrightness = flow.get('transitionBrightness');\n\nconst changeBrightness = () => {\n  if (transitionUp) {\n    transitionBrightness += step;\n    if (transitionBrightness > 100) {\n      transitionBrightness = 100;\n    }\n  } else {\n    transitionBrightness -= step;\n    if (transitionBrightness < min) {\n      transitionBrightness = min;\n    }\n  }\n\n  node.send({\n    payload: {\n      brightness: transitionBrightness\n    }\n  });\n};\n\nchangeBrightness();\n\nflow.set('timer', setInterval(changeBrightness, timeout));",
        "id": "f125214e2289d8dc",
        "initialize": "",
        "libs": [],
        "name": "start timer",
        "noerr": 0,
        "outputs": 1,
        "timeout": 0,
        "type": "function",
        "wires": [
            []
        ],
        "x": 680,
        "y": 300,
        "z": "2d585252458c7615"
    },
    {
        "finalize": "",
        "func": "let timer = flow.get('timer') || null;\n\nif (timer) {\n  clearInterval(timer);\n  timer = null;\n}\n\nflow.set('timer', timer);",
        "id": "362aab73dfafe062",
        "initialize": "",
        "libs": [],
        "name": "stop timer",
        "noerr": 0,
        "outputs": 1,
        "timeout": 0,
        "type": "function",
        "wires": [
            []
        ],
        "x": 680,
        "y": 180,
        "z": "2d585252458c7615"
    },
    {
        "finalize": "",
        "func": "if (msg.type === 'state') {\n  return msg;\n}",
        "id": "5f258bcaab943cf3",
        "initialize": "",
        "libs": [],
        "name": "filter | type = state",
        "noerr": 0,
        "outputs": 1,
        "timeout": 0,
        "type": "function",
        "wires": [
            [
                "0d71b03b0e9f5cea"
            ]
        ],
        "x": 210,
        "y": 60,
        "z": "2d585252458c7615"
    },
    {
        "finalize": "",
        "func": "if (msg.type === 'change') {\n  return msg;\n}",
        "id": "9ac8057d58a83241",
        "initialize": "",
        "libs": [],
        "name": "filter | type = change",
        "noerr": 0,
        "outputs": 1,
        "timeout": 0,
        "type": "function",
        "wires": [
            [
                "891f2718db62c087",
                "70f1720456e3896f",
                "9355e0933b161646",
                "85d863c0570fe74d"
            ]
        ],
        "x": 220,
        "y": 180,
        "z": "2d585252458c7615"
    },
    {
        "finalize": "",
        "func": "flow.set('brightness', msg.payload.brightness);",
        "id": "0d71b03b0e9f5cea",
        "initialize": "",
        "libs": [],
        "name": "set brightness",
        "noerr": 0,
        "outputs": 1,
        "timeout": 0,
        "type": "function",
        "wires": [
            []
        ],
        "x": 480,
        "y": 60,
        "z": "2d585252458c7615"
    },
    {
        "finalize": "",
        "func": "const brightness = flow.get('brightness');\n\nflow.set('transitionBrightness', brightness);",
        "id": "49a1da1ce492843e",
        "initialize": "",
        "libs": [],
        "name": "set transitionBrightness",
        "noerr": 0,
        "outputs": 1,
        "timeout": 0,
        "type": "function",
        "wires": [
            []
        ],
        "x": 730,
        "y": 120,
        "z": "2d585252458c7615"
    },
    {
        "finalize": "",
        "func": "if (msg.payload.event === 'btn_down') {\n  return msg;\n}",
        "id": "85d863c0570fe74d",
        "initialize": "",
        "libs": [],
        "name": "filter | btn_down",
        "noerr": 0,
        "outputs": 1,
        "timeout": 0,
        "type": "function",
        "wires": [
            [
                "49a1da1ce492843e",
                "362aab73dfafe062"
            ]
        ],
        "x": 480,
        "y": 120,
        "z": "2d585252458c7615"
    },
    {
        "finalize": "",
        "func": "const name = `shellies/${env.get('name')}/white/${env.get('relay')}`;\n\nif (msg.topic.startsWith(name)) {\n  return msg;\n}",
        "id": "12e1f1ecacab1fdb",
        "initialize": "",
        "libs": [],
        "name": "filter | by name & relay",
        "noerr": 0,
        "outputs": 1,
        "timeout": 0,
        "type": "function",
        "wires": [
            [
                "0ce888e8a0051fd8"
            ]
        ],
        "x": 220,
        "y": 60,
        "z": "79a320b1aad5b1c6"
    },
    {
        "finalize": "",
        "func": "let state = flow.get('state') || {};\n\nstate = {\n  ...state,\n  ...msg.payload\n};\n\nflow.set('state', state);\n\nreturn {\n  type: 'state',\n  payload: state\n};",
        "id": "44f3564f8666c6dd",
        "initialize": "",
        "libs": [],
        "name": "manage state",
        "noerr": 0,
        "outputs": 1,
        "timeout": 0,
        "type": "function",
        "wires": [
            [
                "a5065b3bda883d72"
            ]
        ],
        "x": 660,
        "y": 60,
        "z": "79a320b1aad5b1c6"
    },
    {
        "finalize": "",
        "func": "if (msg.topic.endsWith('/status')) {\n  const { ison, brightness, overpower } = msg.payload;\n  return {\n    payload: {\n      on: ison,\n      brightness,\n      overpower\n    }\n  };\n}",
        "id": "0ce888e8a0051fd8",
        "initialize": "",
        "libs": [],
        "name": "normalize payload",
        "noerr": 0,
        "outputs": 1,
        "timeout": 0,
        "type": "function",
        "wires": [
            [
                "44f3564f8666c6dd"
            ]
        ],
        "x": 450,
        "y": 60,
        "z": "79a320b1aad5b1c6"
    },
    {
        "func": "rbe",
        "gap": "",
        "id": "a5065b3bda883d72",
        "inout": "out",
        "name": "on change",
        "property": "payload",
        "septopics": false,
        "start": "",
        "topi": "topic",
        "type": "rbe",
        "wires": [
            []
        ],
        "x": 850,
        "y": 60,
        "z": "79a320b1aad5b1c6"
    },
    {
        "finalize": "",
        "func": "const { on, brightness, temperature, overtemperature, overpower } = msg.payload;\nreturn [\n  { payload: on },\n  { payload: brightness },\n  { payload: `${Math.round(temperature)}°C` },\n  { payload: overtemperature ? 'Yes' : 'No' },\n  { payload: overpower  ? 'Yes' : 'No' }\n];",
        "id": "87105726ae6f51c3",
        "initialize": "",
        "libs": [],
        "name": "normalize",
        "noerr": 0,
        "outputs": 5,
        "timeout": 0,
        "type": "function",
        "wires": [
            [
                "ecea76a6f07548a8"
            ],
            [
                "4fa61457792b0719"
            ],
            [
                "29a8a5540af72d48"
            ],
            [
                "f7d2cb73957f7fce"
            ],
            [
                "d862d4f9754b1b06"
            ]
        ],
        "x": 180,
        "y": 140,
        "z": "257349cc625bde40"
    },
    {
        "className": "",
        "group": "4eaae3cca0908442",
        "height": 0,
        "id": "ecea76a6f07548a8",
        "label": "On / Off",
        "name": "toggle | on / off",
        "offcolor": "",
        "officon": "",
        "offvalue": "false",
        "offvalueType": "bool",
        "oncolor": "",
        "onicon": "",
        "onvalue": "true",
        "onvalueType": "bool",
        "order": 1,
        "passthru": false,
        "style": "",
        "topic": "topic",
        "topicType": "msg",
        "type": "ui-switch",
        "width": 0,
        "wires": [
            [
                "83f56f65f7624daf"
            ]
        ],
        "x": 400,
        "y": 60,
        "z": "257349cc625bde40"
    },
    {
        "className": "",
        "color": "#717171",
        "font": "",
        "fontSize": 16,
        "format": "{{msg.payload}}",
        "group": "4eaae3cca0908442",
        "height": 0,
        "id": "29a8a5540af72d48",
        "label": "Temperature",
        "layout": "row-spread",
        "name": "temperature",
        "order": 3,
        "style": false,
        "type": "ui-text",
        "width": 0,
        "wires": [],
        "x": 410,
        "y": 160,
        "z": "257349cc625bde40"
    },
    {
        "className": "",
        "color": "#717171",
        "font": "",
        "fontSize": 16,
        "format": "{{msg.payload}}",
        "group": "4eaae3cca0908442",
        "height": 0,
        "id": "f7d2cb73957f7fce",
        "label": "Overtemperature",
        "layout": "row-spread",
        "name": "overtemperature",
        "order": 4,
        "style": false,
        "type": "ui-text",
        "width": 0,
        "wires": [],
        "x": 420,
        "y": 200,
        "z": "257349cc625bde40"
    },
    {
        "className": "",
        "color": "#717171",
        "font": "",
        "fontSize": 16,
        "format": "{{msg.payload}}",
        "group": "4eaae3cca0908442",
        "height": 0,
        "id": "d862d4f9754b1b06",
        "label": "Overpower",
        "layout": "row-spread",
        "name": "overpower",
        "order": 5,
        "style": false,
        "type": "ui-text",
        "width": 0,
        "wires": [],
        "x": 410,
        "y": 240,
        "z": "257349cc625bde40"
    },
    {
        "className": "",
        "group": "4eaae3cca0908442",
        "height": "0",
        "id": "4fa61457792b0719",
        "label": "Brightness",
        "max": "100",
        "min": "10",
        "name": "brightness",
        "order": 2,
        "outs": "end",
        "passthru": false,
        "step": 1,
        "thumbLabel": true,
        "tooltip": "",
        "topic": "topic",
        "topicType": "msg",
        "type": "ui-slider",
        "width": "0",
        "wires": [
            [
                "e5d2f4247d2c00c0"
            ]
        ],
        "x": 410,
        "y": 100,
        "z": "257349cc625bde40"
    },
    {
        "finalize": "",
        "func": "return {\n  payload: {\n    brightness: msg.payload\n  }\n};",
        "id": "e5d2f4247d2c00c0",
        "initialize": "",
        "l": false,
        "libs": [],
        "name": "",
        "noerr": 0,
        "outputs": 1,
        "timeout": 0,
        "type": "function",
        "wires": [
            []
        ],
        "x": 545,
        "y": 100,
        "z": "257349cc625bde40"
    },
    {
        "finalize": "",
        "func": "return {\n  payload: {\n    turn: msg.payload ? 'on' : 'off'\n  }\n};",
        "id": "83f56f65f7624daf",
        "initialize": "",
        "l": false,
        "libs": [],
        "name": "",
        "noerr": 0,
        "outputs": 1,
        "timeout": 0,
        "type": "function",
        "wires": [
            []
        ],
        "x": 545,
        "y": 60,
        "z": "257349cc625bde40"
    },
    {
        "finalize": "",
        "func": "const { on, brightness, temperature, overtemperature, overpower } = msg.payload;\nreturn [\n  { payload: on },\n  { payload: brightness },\n  { payload: `${Math.round(temperature)}°C` },\n  { payload: overtemperature ? 'Yes' : 'No' },\n  { payload: overpower  ? 'Yes' : 'No' }\n];",
        "id": "8e3c0c5bbcfab58e",
        "initialize": "",
        "libs": [],
        "name": "normalize",
        "noerr": 0,
        "outputs": 5,
        "timeout": 0,
        "type": "function",
        "wires": [
            [
                "9d11cad438b01aca"
            ],
            [
                "7eed7f2482171d35"
            ],
            [
                "7c221813329243e5"
            ],
            [
                "a2d48ddcb4766049"
            ],
            [
                "4f34d8580e7b7843"
            ]
        ],
        "x": 180,
        "y": 140,
        "z": "2e41c0e60bcda4c7"
    },
    {
        "className": "",
        "group": "6fdff81ac0800b78",
        "height": 0,
        "id": "9d11cad438b01aca",
        "label": "On / Off",
        "name": "toggle | on / off",
        "offcolor": "",
        "officon": "",
        "offvalue": "false",
        "offvalueType": "bool",
        "oncolor": "",
        "onicon": "",
        "onvalue": "true",
        "onvalueType": "bool",
        "order": 1,
        "passthru": false,
        "style": "",
        "topic": "topic",
        "topicType": "msg",
        "type": "ui-switch",
        "width": 0,
        "wires": [
            [
                "7437a1d4bb3fa04d"
            ]
        ],
        "x": 400,
        "y": 60,
        "z": "2e41c0e60bcda4c7"
    },
    {
        "className": "",
        "color": "#717171",
        "font": "",
        "fontSize": 16,
        "format": "{{msg.payload}}",
        "group": "6fdff81ac0800b78",
        "height": 0,
        "id": "7c221813329243e5",
        "label": "Temperature",
        "layout": "row-spread",
        "name": "temperature",
        "order": 3,
        "style": false,
        "type": "ui-text",
        "width": 0,
        "wires": [],
        "x": 410,
        "y": 160,
        "z": "2e41c0e60bcda4c7"
    },
    {
        "className": "",
        "color": "#717171",
        "font": "",
        "fontSize": 16,
        "format": "{{msg.payload}}",
        "group": "6fdff81ac0800b78",
        "height": 0,
        "id": "a2d48ddcb4766049",
        "label": "Overtemperature",
        "layout": "row-spread",
        "name": "overtemperature",
        "order": 4,
        "style": false,
        "type": "ui-text",
        "width": 0,
        "wires": [],
        "x": 420,
        "y": 200,
        "z": "2e41c0e60bcda4c7"
    },
    {
        "className": "",
        "color": "#717171",
        "font": "",
        "fontSize": 16,
        "format": "{{msg.payload}}",
        "group": "6fdff81ac0800b78",
        "height": 0,
        "id": "4f34d8580e7b7843",
        "label": "Overpower",
        "layout": "row-spread",
        "name": "overpower",
        "order": 5,
        "style": false,
        "type": "ui-text",
        "width": 0,
        "wires": [],
        "x": 410,
        "y": 240,
        "z": "2e41c0e60bcda4c7"
    },
    {
        "className": "",
        "group": "6fdff81ac0800b78",
        "height": "0",
        "id": "7eed7f2482171d35",
        "label": "Brightness",
        "max": "100",
        "min": "10",
        "name": "brightness",
        "order": 2,
        "outs": "end",
        "passthru": false,
        "step": 1,
        "thumbLabel": true,
        "tooltip": "",
        "topic": "topic",
        "topicType": "msg",
        "type": "ui-slider",
        "width": "0",
        "wires": [
            [
                "644b228c12cab9c9"
            ]
        ],
        "x": 410,
        "y": 100,
        "z": "2e41c0e60bcda4c7"
    },
    {
        "finalize": "",
        "func": "return {\n  payload: {\n    brightness: msg.payload\n  }\n};",
        "id": "644b228c12cab9c9",
        "initialize": "",
        "l": false,
        "libs": [],
        "name": "",
        "noerr": 0,
        "outputs": 1,
        "timeout": 0,
        "type": "function",
        "wires": [
            []
        ],
        "x": 545,
        "y": 100,
        "z": "2e41c0e60bcda4c7"
    },
    {
        "finalize": "",
        "func": "return {\n  payload: {\n    turn: msg.payload ? 'on' : 'off'\n  }\n};",
        "id": "7437a1d4bb3fa04d",
        "initialize": "",
        "l": false,
        "libs": [],
        "name": "",
        "noerr": 0,
        "outputs": 1,
        "timeout": 0,
        "type": "function",
        "wires": [
            []
        ],
        "x": 545,
        "y": 60,
        "z": "2e41c0e60bcda4c7"
    },
    {
        "finalize": "",
        "func": "const { on, brightness, overpower } = msg.payload;\nreturn [\n  { payload: on },\n  { payload: brightness },\n  { payload: overpower  ? 'Yes' : 'No' }\n];",
        "id": "25f52c3ccb5bd276",
        "initialize": "",
        "libs": [],
        "name": "normalize",
        "noerr": 0,
        "outputs": 3,
        "timeout": 0,
        "type": "function",
        "wires": [
            [
                "2226cf3795c65d69"
            ],
            [
                "9cf747c3d848afdc"
            ],
            [
                "e54f2cded58c3dba"
            ]
        ],
        "x": 180,
        "y": 140,
        "z": "2f4e178c5ad4e48d"
    },
    {
        "className": "",
        "group": "0e4aa815f39f2e96",
        "height": 0,
        "id": "2226cf3795c65d69",
        "label": "On / Off",
        "name": "toggle | on / off",
        "offcolor": "",
        "officon": "",
        "offvalue": "false",
        "offvalueType": "bool",
        "oncolor": "",
        "onicon": "",
        "onvalue": "true",
        "onvalueType": "bool",
        "order": 1,
        "passthru": false,
        "style": "",
        "topic": "topic",
        "topicType": "msg",
        "type": "ui-switch",
        "width": 0,
        "wires": [
            []
        ],
        "x": 400,
        "y": 100,
        "z": "2f4e178c5ad4e48d"
    },
    {
        "className": "",
        "group": "0e4aa815f39f2e96",
        "height": "0",
        "id": "9cf747c3d848afdc",
        "label": "Brightness",
        "max": "100",
        "min": "5",
        "name": "brightness",
        "order": 2,
        "outs": "end",
        "passthru": false,
        "step": 1,
        "thumbLabel": true,
        "tooltip": "",
        "topic": "topic",
        "topicType": "msg",
        "type": "ui-slider",
        "width": "0",
        "wires": [
            []
        ],
        "x": 390,
        "y": 140,
        "z": "2f4e178c5ad4e48d"
    },
    {
        "className": "",
        "color": "#717171",
        "font": "",
        "fontSize": 16,
        "format": "{{msg.payload}}",
        "group": "0e4aa815f39f2e96",
        "height": 0,
        "id": "e54f2cded58c3dba",
        "label": "Overpower",
        "layout": "row-spread",
        "name": "overpower",
        "order": 5,
        "style": false,
        "type": "ui-text",
        "width": 0,
        "wires": [],
        "x": 390,
        "y": 180,
        "z": "2f4e178c5ad4e48d"
    },
    {
        "className": "",
        "group": "c153757bd2ce4c9e",
        "height": 0,
        "id": "5e13193493ef2c8a",
        "label": "On / Off",
        "name": "toggle | on / off",
        "offcolor": "",
        "officon": "",
        "offvalue": "false",
        "offvalueType": "bool",
        "oncolor": "",
        "onicon": "",
        "onvalue": "true",
        "onvalueType": "bool",
        "order": 1,
        "passthru": false,
        "style": "",
        "topic": "topic",
        "topicType": "msg",
        "type": "ui-switch",
        "width": 0,
        "wires": [
            []
        ],
        "x": 400,
        "y": 100,
        "z": "5774065fbd82585f"
    },
    {
        "className": "",
        "group": "c153757bd2ce4c9e",
        "height": "0",
        "id": "8a338a12265783b9",
        "label": "Brightness",
        "max": "100",
        "min": "10",
        "name": "brightness",
        "order": 2,
        "outs": "end",
        "passthru": false,
        "step": 1,
        "thumbLabel": true,
        "tooltip": "",
        "topic": "topic",
        "topicType": "msg",
        "type": "ui-slider",
        "width": "0",
        "wires": [
            []
        ],
        "x": 390,
        "y": 140,
        "z": "5774065fbd82585f"
    },
    {
        "finalize": "",
        "func": "const { on, brightness, overpower } = msg.payload;\nreturn [\n  { payload: on },\n  { payload: brightness },\n  { payload: overpower  ? 'Yes' : 'No' }\n];",
        "id": "bb8e6dbe32cb2930",
        "initialize": "",
        "libs": [],
        "name": "normalize",
        "noerr": 0,
        "outputs": 3,
        "timeout": 0,
        "type": "function",
        "wires": [
            [
                "5e13193493ef2c8a"
            ],
            [
                "8a338a12265783b9"
            ],
            [
                "acaf320a57ef8c80"
            ]
        ],
        "x": 180,
        "y": 140,
        "z": "5774065fbd82585f"
    },
    {
        "className": "",
        "color": "#717171",
        "font": "",
        "fontSize": 16,
        "format": "{{msg.payload}}",
        "group": "c153757bd2ce4c9e",
        "height": 0,
        "id": "acaf320a57ef8c80",
        "label": "Overpower",
        "layout": "row-spread",
        "name": "overpower",
        "order": 5,
        "style": false,
        "type": "ui-text",
        "width": 0,
        "wires": [],
        "x": 390,
        "y": 180,
        "z": "5774065fbd82585f"
    },
    {
        "finalize": "",
        "func": "const { on, brightness, temperature, overtemperature, overpower } = msg.payload;\nreturn [\n  { payload: on },\n  { payload: brightness },\n  { payload: `${Math.round(temperature)}°C` },\n  { payload: overtemperature ? 'Yes' : 'No' },\n  { payload: overpower  ? 'Yes' : 'No' }\n];",
        "id": "77cd0b5e15e80ca5",
        "initialize": "",
        "libs": [],
        "name": "normalize",
        "noerr": 0,
        "outputs": 5,
        "timeout": 0,
        "type": "function",
        "wires": [
            [
                "218386783758f116"
            ],
            [
                "d2c55e7f68775f26"
            ],
            [
                "135d3e12242a3c93"
            ],
            [
                "644644fc990ab05c"
            ],
            [
                "5c60f2eaecb84664"
            ]
        ],
        "x": 180,
        "y": 140,
        "z": "d21607ed4bd9c3e2"
    },
    {
        "className": "",
        "group": "7249de5d656a05c1",
        "height": 0,
        "id": "218386783758f116",
        "label": "On / Off",
        "name": "toggle | on / off",
        "offcolor": "",
        "officon": "",
        "offvalue": "false",
        "offvalueType": "bool",
        "oncolor": "",
        "onicon": "",
        "onvalue": "true",
        "onvalueType": "bool",
        "order": 1,
        "passthru": false,
        "style": "",
        "topic": "topic",
        "topicType": "msg",
        "type": "ui-switch",
        "width": 0,
        "wires": [
            [
                "1c96a615e0e16a2a"
            ]
        ],
        "x": 400,
        "y": 60,
        "z": "d21607ed4bd9c3e2"
    },
    {
        "className": "",
        "color": "#717171",
        "font": "",
        "fontSize": 16,
        "format": "{{msg.payload}}",
        "group": "7249de5d656a05c1",
        "height": 0,
        "id": "135d3e12242a3c93",
        "label": "Temperature",
        "layout": "row-spread",
        "name": "temperature",
        "order": 3,
        "style": false,
        "type": "ui-text",
        "width": 0,
        "wires": [],
        "x": 410,
        "y": 160,
        "z": "d21607ed4bd9c3e2"
    },
    {
        "className": "",
        "color": "#717171",
        "font": "",
        "fontSize": 16,
        "format": "{{msg.payload}}",
        "group": "7249de5d656a05c1",
        "height": 0,
        "id": "644644fc990ab05c",
        "label": "Overtemperature",
        "layout": "row-spread",
        "name": "overtemperature",
        "order": 4,
        "style": false,
        "type": "ui-text",
        "width": 0,
        "wires": [],
        "x": 420,
        "y": 200,
        "z": "d21607ed4bd9c3e2"
    },
    {
        "className": "",
        "color": "#717171",
        "font": "",
        "fontSize": 16,
        "format": "{{msg.payload}}",
        "group": "7249de5d656a05c1",
        "height": 0,
        "id": "5c60f2eaecb84664",
        "label": "Overpower",
        "layout": "row-spread",
        "name": "overpower",
        "order": 5,
        "style": false,
        "type": "ui-text",
        "width": 0,
        "wires": [],
        "x": 410,
        "y": 240,
        "z": "d21607ed4bd9c3e2"
    },
    {
        "className": "",
        "group": "7249de5d656a05c1",
        "height": "0",
        "id": "d2c55e7f68775f26",
        "label": "Brightness",
        "max": "100",
        "min": "10",
        "name": "brightness",
        "order": 2,
        "outs": "end",
        "passthru": false,
        "step": 1,
        "thumbLabel": true,
        "tooltip": "",
        "topic": "topic",
        "topicType": "msg",
        "type": "ui-slider",
        "width": "0",
        "wires": [
            [
                "a9a824ef599a2398"
            ]
        ],
        "x": 410,
        "y": 100,
        "z": "d21607ed4bd9c3e2"
    },
    {
        "finalize": "",
        "func": "return {\n  payload: {\n    brightness: msg.payload\n  }\n};",
        "id": "a9a824ef599a2398",
        "initialize": "",
        "l": false,
        "libs": [],
        "name": "",
        "noerr": 0,
        "outputs": 1,
        "timeout": 0,
        "type": "function",
        "wires": [
            []
        ],
        "x": 545,
        "y": 100,
        "z": "d21607ed4bd9c3e2"
    },
    {
        "finalize": "",
        "func": "return {\n  payload: {\n    turn: msg.payload ? 'on' : 'off'\n  }\n};",
        "id": "1c96a615e0e16a2a",
        "initialize": "",
        "l": false,
        "libs": [],
        "name": "",
        "noerr": 0,
        "outputs": 1,
        "timeout": 0,
        "type": "function",
        "wires": [
            []
        ],
        "x": 545,
        "y": 60,
        "z": "d21607ed4bd9c3e2"
    },
    {
        "finalize": "",
        "func": "const { on, brightness, temperature, overtemperature, overpower } = msg.payload;\nreturn [\n  { payload: on },\n  { payload: brightness },\n  { payload: `${Math.round(temperature)}°C` },\n  { payload: overtemperature ? 'Yes' : 'No' },\n  { payload: overpower  ? 'Yes' : 'No' }\n];",
        "id": "e4aee0817bc0e922",
        "initialize": "",
        "libs": [],
        "name": "normalize",
        "noerr": 0,
        "outputs": 5,
        "timeout": 0,
        "type": "function",
        "wires": [
            [
                "7125360eafae9db3"
            ],
            [
                "f2367ffbac3d56ab"
            ],
            [
                "7eb7e9be7cc088b1"
            ],
            [
                "46251cc8bed15393"
            ],
            [
                "1909f0c6228858d2"
            ]
        ],
        "x": 180,
        "y": 140,
        "z": "fbc53d40d3ad022e"
    },
    {
        "className": "",
        "group": "c54dde3886a22377",
        "height": 0,
        "id": "7125360eafae9db3",
        "label": "On / Off",
        "name": "toggle | on / off",
        "offcolor": "",
        "officon": "",
        "offvalue": "false",
        "offvalueType": "bool",
        "oncolor": "",
        "onicon": "",
        "onvalue": "true",
        "onvalueType": "bool",
        "order": 1,
        "passthru": false,
        "style": "",
        "topic": "topic",
        "topicType": "msg",
        "type": "ui-switch",
        "width": 0,
        "wires": [
            [
                "f1f1638e07590e44"
            ]
        ],
        "x": 400,
        "y": 60,
        "z": "fbc53d40d3ad022e"
    },
    {
        "className": "",
        "color": "#717171",
        "font": "",
        "fontSize": 16,
        "format": "{{msg.payload}}",
        "group": "c54dde3886a22377",
        "height": 0,
        "id": "7eb7e9be7cc088b1",
        "label": "Temperature",
        "layout": "row-spread",
        "name": "temperature",
        "order": 3,
        "style": false,
        "type": "ui-text",
        "width": 0,
        "wires": [],
        "x": 410,
        "y": 160,
        "z": "fbc53d40d3ad022e"
    },
    {
        "className": "",
        "color": "#717171",
        "font": "",
        "fontSize": 16,
        "format": "{{msg.payload}}",
        "group": "c54dde3886a22377",
        "height": 0,
        "id": "46251cc8bed15393",
        "label": "Overtemperature",
        "layout": "row-spread",
        "name": "overtemperature",
        "order": 4,
        "style": false,
        "type": "ui-text",
        "width": 0,
        "wires": [],
        "x": 420,
        "y": 200,
        "z": "fbc53d40d3ad022e"
    },
    {
        "className": "",
        "color": "#717171",
        "font": "",
        "fontSize": 16,
        "format": "{{msg.payload}}",
        "group": "c54dde3886a22377",
        "height": 0,
        "id": "1909f0c6228858d2",
        "label": "Overpower",
        "layout": "row-spread",
        "name": "overpower",
        "order": 5,
        "style": false,
        "type": "ui-text",
        "width": 0,
        "wires": [],
        "x": 410,
        "y": 240,
        "z": "fbc53d40d3ad022e"
    },
    {
        "className": "",
        "group": "c54dde3886a22377",
        "height": "0",
        "id": "f2367ffbac3d56ab",
        "label": "Brightness",
        "max": "100",
        "min": "10",
        "name": "brightness",
        "order": 2,
        "outs": "end",
        "passthru": false,
        "step": 1,
        "thumbLabel": true,
        "tooltip": "",
        "topic": "topic",
        "topicType": "msg",
        "type": "ui-slider",
        "width": "0",
        "wires": [
            [
                "306e40ce157269d1"
            ]
        ],
        "x": 410,
        "y": 100,
        "z": "fbc53d40d3ad022e"
    },
    {
        "finalize": "",
        "func": "return {\n  payload: {\n    brightness: msg.payload\n  }\n};",
        "id": "306e40ce157269d1",
        "initialize": "",
        "l": false,
        "libs": [],
        "name": "",
        "noerr": 0,
        "outputs": 1,
        "timeout": 0,
        "type": "function",
        "wires": [
            []
        ],
        "x": 545,
        "y": 100,
        "z": "fbc53d40d3ad022e"
    },
    {
        "finalize": "",
        "func": "return {\n  payload: {\n    turn: msg.payload ? 'on' : 'off'\n  }\n};",
        "id": "f1f1638e07590e44",
        "initialize": "",
        "l": false,
        "libs": [],
        "name": "",
        "noerr": 0,
        "outputs": 1,
        "timeout": 0,
        "type": "function",
        "wires": [
            []
        ],
        "x": 545,
        "y": 60,
        "z": "fbc53d40d3ad022e"
    },
    {
        "finalize": "",
        "func": "const { on, brightness, temperature, overtemperature, overpower } = msg.payload;\nreturn [\n  { payload: on },\n  { payload: brightness },\n  { payload: `${Math.round(temperature)}°C` },\n  { payload: overtemperature ? 'Yes' : 'No' },\n  { payload: overpower  ? 'Yes' : 'No' }\n];",
        "id": "41396108be566aa7",
        "initialize": "",
        "libs": [],
        "name": "normalize",
        "noerr": 0,
        "outputs": 5,
        "timeout": 0,
        "type": "function",
        "wires": [
            [
                "e6204061a370d9d4"
            ],
            [
                "37a5e730bc07008f"
            ],
            [
                "ce31adb8f06df631"
            ],
            [
                "f3b23c25ce1274ad"
            ],
            [
                "8606db73e291e20d"
            ]
        ],
        "x": 180,
        "y": 140,
        "z": "cc0cff40c0be42c3"
    },
    {
        "className": "",
        "group": "86b9d12ad87eaa24",
        "height": 0,
        "id": "e6204061a370d9d4",
        "label": "On / Off",
        "name": "toggle | on / off",
        "offcolor": "",
        "officon": "",
        "offvalue": "false",
        "offvalueType": "bool",
        "oncolor": "",
        "onicon": "",
        "onvalue": "true",
        "onvalueType": "bool",
        "order": 1,
        "passthru": false,
        "style": "",
        "topic": "topic",
        "topicType": "msg",
        "type": "ui-switch",
        "width": 0,
        "wires": [
            [
                "76ba3f16808db218"
            ]
        ],
        "x": 400,
        "y": 60,
        "z": "cc0cff40c0be42c3"
    },
    {
        "className": "",
        "color": "#717171",
        "font": "",
        "fontSize": 16,
        "format": "{{msg.payload}}",
        "group": "86b9d12ad87eaa24",
        "height": 0,
        "id": "ce31adb8f06df631",
        "label": "Temperature",
        "layout": "row-spread",
        "name": "temperature",
        "order": 3,
        "style": false,
        "type": "ui-text",
        "width": 0,
        "wires": [],
        "x": 410,
        "y": 160,
        "z": "cc0cff40c0be42c3"
    },
    {
        "className": "",
        "color": "#717171",
        "font": "",
        "fontSize": 16,
        "format": "{{msg.payload}}",
        "group": "86b9d12ad87eaa24",
        "height": 0,
        "id": "f3b23c25ce1274ad",
        "label": "Overtemperature",
        "layout": "row-spread",
        "name": "overtemperature",
        "order": 4,
        "style": false,
        "type": "ui-text",
        "width": 0,
        "wires": [],
        "x": 420,
        "y": 200,
        "z": "cc0cff40c0be42c3"
    },
    {
        "className": "",
        "color": "#717171",
        "font": "",
        "fontSize": 16,
        "format": "{{msg.payload}}",
        "group": "86b9d12ad87eaa24",
        "height": 0,
        "id": "8606db73e291e20d",
        "label": "Overpower",
        "layout": "row-spread",
        "name": "overpower",
        "order": 5,
        "style": false,
        "type": "ui-text",
        "width": 0,
        "wires": [],
        "x": 410,
        "y": 240,
        "z": "cc0cff40c0be42c3"
    },
    {
        "className": "",
        "group": "86b9d12ad87eaa24",
        "height": "0",
        "id": "37a5e730bc07008f",
        "label": "Brightness",
        "max": "100",
        "min": "10",
        "name": "brightness",
        "order": 2,
        "outs": "end",
        "passthru": false,
        "step": 1,
        "thumbLabel": true,
        "tooltip": "",
        "topic": "topic",
        "topicType": "msg",
        "type": "ui-slider",
        "width": "0",
        "wires": [
            [
                "29b930154dd0844b"
            ]
        ],
        "x": 410,
        "y": 100,
        "z": "cc0cff40c0be42c3"
    },
    {
        "finalize": "",
        "func": "return {\n  payload: {\n    brightness: msg.payload\n  }\n};",
        "id": "29b930154dd0844b",
        "initialize": "",
        "l": false,
        "libs": [],
        "name": "",
        "noerr": 0,
        "outputs": 1,
        "timeout": 0,
        "type": "function",
        "wires": [
            []
        ],
        "x": 545,
        "y": 100,
        "z": "cc0cff40c0be42c3"
    },
    {
        "finalize": "",
        "func": "return {\n  payload: {\n    turn: msg.payload ? 'on' : 'off'\n  }\n};",
        "id": "76ba3f16808db218",
        "initialize": "",
        "l": false,
        "libs": [],
        "name": "",
        "noerr": 0,
        "outputs": 1,
        "timeout": 0,
        "type": "function",
        "wires": [
            []
        ],
        "x": 545,
        "y": 60,
        "z": "cc0cff40c0be42c3"
    },
    {
        "finalize": "",
        "func": "const { on, brightness, temperature, overtemperature, overpower } = msg.payload;\nreturn [\n  { payload: on },\n  { payload: brightness },\n  { payload: `${Math.round(temperature)}°C` },\n  { payload: overtemperature ? 'Yes' : 'No' },\n  { payload: overpower  ? 'Yes' : 'No' }\n];",
        "id": "03a5ec83b7d528fe",
        "initialize": "",
        "libs": [],
        "name": "normalize",
        "noerr": 0,
        "outputs": 5,
        "timeout": 0,
        "type": "function",
        "wires": [
            [
                "aa8b98e7c7536972"
            ],
            [
                "ba06b8b0527944b1"
            ],
            [
                "0372ed18c6b987a3"
            ],
            [
                "cfd249f670fcb5d9"
            ],
            [
                "4b0fd05e31cca2f8"
            ]
        ],
        "x": 180,
        "y": 140,
        "z": "56930ca583a30724"
    },
    {
        "className": "",
        "group": "51c5f0b66acb1db3",
        "height": 0,
        "id": "aa8b98e7c7536972",
        "label": "On / Off",
        "name": "toggle | on / off",
        "offcolor": "",
        "officon": "",
        "offvalue": "false",
        "offvalueType": "bool",
        "oncolor": "",
        "onicon": "",
        "onvalue": "true",
        "onvalueType": "bool",
        "order": 1,
        "passthru": false,
        "style": "",
        "topic": "topic",
        "topicType": "msg",
        "type": "ui-switch",
        "width": 0,
        "wires": [
            [
                "6ce2745bad15b2e7"
            ]
        ],
        "x": 400,
        "y": 60,
        "z": "56930ca583a30724"
    },
    {
        "className": "",
        "color": "#717171",
        "font": "",
        "fontSize": 16,
        "format": "{{msg.payload}}",
        "group": "51c5f0b66acb1db3",
        "height": 0,
        "id": "0372ed18c6b987a3",
        "label": "Temperature",
        "layout": "row-spread",
        "name": "temperature",
        "order": 3,
        "style": false,
        "type": "ui-text",
        "width": 0,
        "wires": [],
        "x": 410,
        "y": 160,
        "z": "56930ca583a30724"
    },
    {
        "className": "",
        "color": "#717171",
        "font": "",
        "fontSize": 16,
        "format": "{{msg.payload}}",
        "group": "51c5f0b66acb1db3",
        "height": 0,
        "id": "cfd249f670fcb5d9",
        "label": "Overtemperature",
        "layout": "row-spread",
        "name": "overtemperature",
        "order": 4,
        "style": false,
        "type": "ui-text",
        "width": 0,
        "wires": [],
        "x": 420,
        "y": 200,
        "z": "56930ca583a30724"
    },
    {
        "className": "",
        "color": "#717171",
        "font": "",
        "fontSize": 16,
        "format": "{{msg.payload}}",
        "group": "51c5f0b66acb1db3",
        "height": 0,
        "id": "4b0fd05e31cca2f8",
        "label": "Overpower",
        "layout": "row-spread",
        "name": "overpower",
        "order": 5,
        "style": false,
        "type": "ui-text",
        "width": 0,
        "wires": [],
        "x": 410,
        "y": 240,
        "z": "56930ca583a30724"
    },
    {
        "className": "",
        "group": "51c5f0b66acb1db3",
        "height": "0",
        "id": "ba06b8b0527944b1",
        "label": "Brightness",
        "max": "100",
        "min": "10",
        "name": "brightness",
        "order": 2,
        "outs": "end",
        "passthru": false,
        "step": 1,
        "thumbLabel": true,
        "tooltip": "",
        "topic": "topic",
        "topicType": "msg",
        "type": "ui-slider",
        "width": "0",
        "wires": [
            [
                "c16a2a3d81b55902"
            ]
        ],
        "x": 410,
        "y": 100,
        "z": "56930ca583a30724"
    },
    {
        "finalize": "",
        "func": "return {\n  payload: {\n    brightness: msg.payload\n  }\n};",
        "id": "c16a2a3d81b55902",
        "initialize": "",
        "l": false,
        "libs": [],
        "name": "",
        "noerr": 0,
        "outputs": 1,
        "timeout": 0,
        "type": "function",
        "wires": [
            []
        ],
        "x": 545,
        "y": 100,
        "z": "56930ca583a30724"
    },
    {
        "finalize": "",
        "func": "return {\n  payload: {\n    turn: msg.payload ? 'on' : 'off'\n  }\n};",
        "id": "6ce2745bad15b2e7",
        "initialize": "",
        "l": false,
        "libs": [],
        "name": "",
        "noerr": 0,
        "outputs": 1,
        "timeout": 0,
        "type": "function",
        "wires": [
            []
        ],
        "x": 545,
        "y": 60,
        "z": "56930ca583a30724"
    },
    {
        "broker": "872ce2a0d0bada26",
        "datatype": "auto-detect",
        "g": "70e28aaa371d1526",
        "id": "a7f2a6506d759447",
        "inputs": 0,
        "name": "mqtt",
        "nl": false,
        "qos": "2",
        "rap": true,
        "rh": 0,
        "topic": "#",
        "type": "mqtt in",
        "wires": [
            [
                "2df5cf650d34edcc",
                "c7d95af3ca07ce4b",
                "827e07c098b505e0"
            ]
        ],
        "x": 90,
        "y": 120,
        "z": "a0a86b2bcc8e6558"
    },
    {
        "env": [
            {
                "name": "name",
                "type": "str",
                "value": "kitchen-lamp"
            }
        ],
        "g": "70e28aaa371d1526",
        "id": "2df5cf650d34edcc",
        "name": "dimmer in | kitchen lamp",
        "type": "subflow:492ba385940b0a9c",
        "wires": [
            [
                "4daba07e960c2eeb",
                "aee391f4442804ee"
            ]
        ],
        "x": 290,
        "y": 80,
        "z": "a0a86b2bcc8e6558"
    },
    {
        "broker": "872ce2a0d0bada26",
        "contentType": "",
        "correl": "",
        "expiry": "",
        "g": "70e28aaa371d1526",
        "id": "afe24f902e571f2e",
        "name": "",
        "qos": "",
        "respTopic": "",
        "retain": "",
        "topic": "",
        "type": "mqtt out",
        "userProps": "",
        "wires": [],
        "x": 930,
        "y": 100,
        "z": "a0a86b2bcc8e6558"
    },
    {
        "env": [
            {
                "name": "name",
                "type": "str",
                "value": "kitchen-lamp"
            }
        ],
        "g": "70e28aaa371d1526",
        "id": "715338d3f4fb3ac7",
        "name": "dimmer out | kitchen lamp",
        "type": "subflow:4c0cd1386899de21",
        "wires": [
            [
                "afe24f902e571f2e"
            ]
        ],
        "x": 750,
        "y": 100,
        "z": "a0a86b2bcc8e6558"
    },
    {
        "env": [
            {
                "name": "name",
                "type": "str",
                "value": "living-room-buttons"
            },
            {
                "name": "button",
                "type": "num",
                "value": "3"
            },
            {
                "name": "buttonId",
                "type": "num",
                "value": "0"
            },
            {
                "name": "id",
                "type": "num",
                "value": "0"
            },
            {
                "name": "input",
                "type": "num",
                "value": "0"
            }
        ],
        "g": "70e28aaa371d1526",
        "id": "827e07c098b505e0",
        "name": "buttons | living room | 3",
        "type": "subflow:cbef3ce630f61ff7",
        "wires": [
            [
                "4daba07e960c2eeb"
            ]
        ],
        "x": 290,
        "y": 160,
        "z": "a0a86b2bcc8e6558"
    },
    {
        "env": [
            {
                "name": "timeout",
                "type": "num",
                "value": "500"
            },
            {
                "name": "step",
                "type": "num",
                "value": "5"
            }
        ],
        "g": "70e28aaa371d1526",
        "id": "4daba07e960c2eeb",
        "name": "",
        "type": "subflow:2d585252458c7615",
        "wires": [
            [
                "715338d3f4fb3ac7"
            ]
        ],
        "x": 530,
        "y": 120,
        "z": "a0a86b2bcc8e6558"
    },
    {
        "broker": "872ce2a0d0bada26",
        "datatype": "auto-detect",
        "g": "f55d2c7b19e0ede8",
        "id": "1ede78aab2135743",
        "inputs": 0,
        "name": "mqtt",
        "nl": false,
        "qos": "2",
        "rap": true,
        "rh": 0,
        "topic": "#",
        "type": "mqtt in",
        "wires": [
            [
                "44960675995b0228",
                "b6923abe8da22af2",
                "8650945b0b55de40"
            ]
        ],
        "x": 90,
        "y": 300,
        "z": "a0a86b2bcc8e6558"
    },
    {
        "env": [
            {
                "name": "name",
                "type": "str",
                "value": "kitchen-buttons"
            },
            {
                "name": "button",
                "type": "num",
                "value": "0"
            },
            {
                "name": "buttonId",
                "type": "num",
                "value": "0"
            },
            {
                "name": "id",
                "type": "num",
                "value": "0"
            },
            {
                "name": "input",
                "type": "num",
                "value": "0"
            }
        ],
        "g": "70e28aaa371d1526",
        "id": "c7d95af3ca07ce4b",
        "name": "buttons | kitchen | 0",
        "type": "subflow:cbef3ce630f61ff7",
        "wires": [
            [
                "4daba07e960c2eeb"
            ]
        ],
        "x": 270,
        "y": 120,
        "z": "a0a86b2bcc8e6558"
    },
    {
        "env": [
            {
                "name": "name",
                "type": "str",
                "value": "sofa-lamp"
            }
        ],
        "g": "f55d2c7b19e0ede8",
        "id": "44960675995b0228",
        "name": "dimmer in | sofa lamp",
        "type": "subflow:492ba385940b0a9c",
        "wires": [
            [
                "d6ce41d151adbb27",
                "1c05965e272d4559"
            ]
        ],
        "x": 280,
        "y": 260,
        "z": "a0a86b2bcc8e6558"
    },
    {
        "env": [
            {
                "name": "name",
                "type": "str",
                "value": "kitchen-buttons"
            },
            {
                "name": "button",
                "type": "num",
                "value": "1"
            },
            {
                "name": "buttonId",
                "type": "num",
                "value": "0"
            },
            {
                "name": "id",
                "type": "num",
                "value": "0"
            },
            {
                "name": "input",
                "type": "num",
                "value": "0"
            }
        ],
        "g": "f55d2c7b19e0ede8",
        "id": "b6923abe8da22af2",
        "name": "buttons in | kitchen | 1",
        "type": "subflow:cbef3ce630f61ff7",
        "wires": [
            [
                "d6ce41d151adbb27"
            ]
        ],
        "x": 280,
        "y": 300,
        "z": "a0a86b2bcc8e6558"
    },
    {
        "env": [
            {
                "name": "name",
                "type": "str",
                "value": "living-room-buttons"
            },
            {
                "name": "button",
                "type": "num",
                "value": "2"
            },
            {
                "name": "buttonId",
                "type": "num",
                "value": "0"
            },
            {
                "name": "id",
                "type": "num",
                "value": "0"
            },
            {
                "name": "input",
                "type": "num",
                "value": "0"
            }
        ],
        "g": "f55d2c7b19e0ede8",
        "id": "8650945b0b55de40",
        "name": "buttons in | living room | 2",
        "type": "subflow:cbef3ce630f61ff7",
        "wires": [
            [
                "d6ce41d151adbb27"
            ]
        ],
        "x": 290,
        "y": 340,
        "z": "a0a86b2bcc8e6558"
    },
    {
        "env": [
            {
                "name": "timeout",
                "type": "num",
                "value": "500"
            },
            {
                "name": "step",
                "type": "num",
                "value": "5"
            }
        ],
        "g": "f55d2c7b19e0ede8",
        "id": "d6ce41d151adbb27",
        "name": "",
        "type": "subflow:2d585252458c7615",
        "wires": [
            [
                "68903cc1339976f2"
            ]
        ],
        "x": 530,
        "y": 300,
        "z": "a0a86b2bcc8e6558"
    },
    {
        "env": [
            {
                "name": "name",
                "type": "str",
                "value": "sofa-lamp"
            }
        ],
        "g": "f55d2c7b19e0ede8",
        "id": "68903cc1339976f2",
        "name": "dimmer out | sofa lamp",
        "type": "subflow:4c0cd1386899de21",
        "wires": [
            [
                "8ca38bb40b5b141a"
            ]
        ],
        "x": 740,
        "y": 280,
        "z": "a0a86b2bcc8e6558"
    },
    {
        "broker": "872ce2a0d0bada26",
        "contentType": "",
        "correl": "",
        "expiry": "",
        "g": "f55d2c7b19e0ede8",
        "id": "8ca38bb40b5b141a",
        "name": "",
        "qos": "",
        "respTopic": "",
        "retain": "",
        "topic": "",
        "type": "mqtt out",
        "userProps": "",
        "wires": [],
        "x": 930,
        "y": 280,
        "z": "a0a86b2bcc8e6558"
    },
    {
        "broker": "872ce2a0d0bada26",
        "datatype": "auto-detect",
        "g": "e41b34ecb4de2eb1",
        "id": "897f1c25eac5ef6b",
        "inputs": 0,
        "name": "mqtt",
        "nl": false,
        "qos": "2",
        "rap": true,
        "rh": 0,
        "topic": "#",
        "type": "mqtt in",
        "wires": [
            [
                "adea4321f7d65fbc",
                "0f6e5e05a384ccbc",
                "9c001ea7d54b0057"
            ]
        ],
        "x": 90,
        "y": 480,
        "z": "a0a86b2bcc8e6558"
    },
    {
        "env": [
            {
                "name": "name",
                "type": "str",
                "value": "rgbw-1"
            },
            {
                "name": "relay",
                "type": "num",
                "value": "2"
            }
        ],
        "g": "e41b34ecb4de2eb1",
        "id": "adea4321f7d65fbc",
        "name": "rgbw-1 | relay 2",
        "type": "subflow:79a320b1aad5b1c6",
        "wires": [
            [
                "c43d88f0a6cf9ecb",
                "7a1427a0b4711d76"
            ]
        ],
        "x": 260,
        "y": 440,
        "z": "a0a86b2bcc8e6558"
    },
    {
        "env": [
            {
                "name": "name",
                "type": "str",
                "value": "kitchen-buttons"
            },
            {
                "name": "button",
                "type": "num",
                "value": "2"
            },
            {
                "name": "buttonId",
                "type": "num",
                "value": "0"
            },
            {
                "name": "id",
                "type": "num",
                "value": "0"
            },
            {
                "name": "input",
                "type": "num",
                "value": "0"
            }
        ],
        "g": "e41b34ecb4de2eb1",
        "id": "0f6e5e05a384ccbc",
        "name": "buttons in | kitchen | 2",
        "type": "subflow:cbef3ce630f61ff7",
        "wires": [
            [
                "c43d88f0a6cf9ecb"
            ]
        ],
        "x": 280,
        "y": 480,
        "z": "a0a86b2bcc8e6558"
    },
    {
        "env": [
            {
                "name": "timeout",
                "type": "num",
                "value": "500"
            },
            {
                "name": "step",
                "type": "num",
                "value": "5"
            }
        ],
        "g": "e41b34ecb4de2eb1",
        "id": "c43d88f0a6cf9ecb",
        "name": "",
        "type": "subflow:2d585252458c7615",
        "wires": [
            [
                "dcd2cc4da81c2d2b"
            ]
        ],
        "x": 530,
        "y": 480,
        "z": "a0a86b2bcc8e6558"
    },
    {
        "finalize": "",
        "func": "const topics = [\n  'shellies/rgbw-1/white/2/set',\n  'shellies/rgbw-1/white/3/set',\n];\n\nfor (const topic of topics) {\n  node.send({\n    topic,\n    payload: {\n      turn: 'toggle'\n    }\n  });\n}",
        "g": "e41b34ecb4de2eb1",
        "id": "4fc074817167e9f9",
        "initialize": "",
        "libs": [],
        "name": "toggle | ambient",
        "noerr": 0,
        "outputs": 1,
        "timeout": 0,
        "type": "function",
        "wires": [
            [
                "9028556566f2cb37"
            ]
        ],
        "x": 780,
        "y": 440,
        "z": "a0a86b2bcc8e6558"
    },
    {
        "broker": "872ce2a0d0bada26",
        "contentType": "",
        "correl": "",
        "expiry": "",
        "g": "e41b34ecb4de2eb1",
        "id": "9028556566f2cb37",
        "name": "",
        "qos": "",
        "respTopic": "",
        "retain": "",
        "topic": "",
        "type": "mqtt out",
        "userProps": "",
        "wires": [],
        "x": 1010,
        "y": 440,
        "z": "a0a86b2bcc8e6558"
    },
    {
        "env": [
            {
                "name": "name",
                "type": "str",
                "value": "living-room-buttons"
            },
            {
                "name": "button",
                "type": "num",
                "value": "0"
            },
            {
                "name": "buttonId",
                "type": "num",
                "value": "0"
            },
            {
                "name": "id",
                "type": "num",
                "value": "0"
            },
            {
                "name": "input",
                "type": "num",
                "value": "0"
            }
        ],
        "g": "e41b34ecb4de2eb1",
        "id": "9c001ea7d54b0057",
        "name": "buttons in | living room | 0",
        "type": "subflow:cbef3ce630f61ff7",
        "wires": [
            [
                "c43d88f0a6cf9ecb"
            ]
        ],
        "x": 290,
        "y": 520,
        "z": "a0a86b2bcc8e6558"
    },
    {
        "finalize": "",
        "func": "const topics = [\n  'shellies/rgbw-1/white/2/set',\n  'shellies/rgbw-1/white/3/set',\n];\n\nfor (const topic of topics) {\n  node.send({\n    topic,\n    payload: {\n      'brightness': msg.payload.brightness || msg.payload\n    }\n  });\n}",
        "g": "e41b34ecb4de2eb1",
        "id": "03a7df41c74aca51",
        "initialize": "",
        "libs": [],
        "name": "brightness | ambient",
        "noerr": 0,
        "outputs": 1,
        "timeout": 0,
        "type": "function",
        "wires": [
            [
                "9028556566f2cb37"
            ]
        ],
        "x": 820,
        "y": 480,
        "z": "a0a86b2bcc8e6558"
    },
    {
        "g": "70e28aaa371d1526",
        "id": "aee391f4442804ee",
        "name": "",
        "type": "subflow:257349cc625bde40",
        "wires": [
            [
                "715338d3f4fb3ac7"
            ]
        ],
        "x": 530,
        "y": 80,
        "z": "a0a86b2bcc8e6558"
    },
    {
        "g": "f55d2c7b19e0ede8",
        "id": "1c05965e272d4559",
        "name": "",
        "type": "subflow:2e41c0e60bcda4c7",
        "wires": [
            [
                "68903cc1339976f2"
            ]
        ],
        "x": 530,
        "y": 260,
        "z": "a0a86b2bcc8e6558"
    },
    {
        "finalize": "",
        "func": "if (msg.payload.turn) {\n  return [msg];\n}\n\nelse if (msg.payload.brightness) {\n  return [null, msg];\n}",
        "g": "e41b34ecb4de2eb1",
        "id": "dcd2cc4da81c2d2b",
        "initialize": "",
        "l": false,
        "libs": [],
        "name": "function 1",
        "noerr": 0,
        "outputs": 2,
        "timeout": 0,
        "type": "function",
        "wires": [
            [
                "4fc074817167e9f9"
            ],
            [
                "03a7df41c74aca51"
            ]
        ],
        "x": 635,
        "y": 480,
        "z": "a0a86b2bcc8e6558"
    },
    {
        "g": "e41b34ecb4de2eb1",
        "id": "7a1427a0b4711d76",
        "name": "",
        "type": "subflow:2f4e178c5ad4e48d",
        "wires": [
            [
                "4fc074817167e9f9"
            ],
            [
                "03a7df41c74aca51"
            ]
        ],
        "x": 530,
        "y": 440,
        "z": "a0a86b2bcc8e6558"
    },
    {
        "env": [
            {
                "name": "name",
                "type": "str",
                "value": "kitchen-buttons"
            },
            {
                "name": "button",
                "type": "num",
                "value": "3"
            },
            {
                "name": "buttonId",
                "type": "num",
                "value": "0"
            },
            {
                "name": "id",
                "type": "num",
                "value": "0"
            },
            {
                "name": "input",
                "type": "num",
                "value": "0"
            }
        ],
        "g": "7e6a568d010b4632",
        "id": "c6b94d40a07b7571",
        "name": "buttons in | kitchen | 3",
        "type": "subflow:cbef3ce630f61ff7",
        "wires": [
            [
                "913682f3b59ac52b"
            ]
        ],
        "x": 280,
        "y": 660,
        "z": "a0a86b2bcc8e6558"
    },
    {
        "env": [
            {
                "name": "timeout",
                "type": "num",
                "value": "500"
            },
            {
                "name": "step",
                "type": "num",
                "value": "5"
            }
        ],
        "g": "7e6a568d010b4632",
        "id": "913682f3b59ac52b",
        "name": "",
        "type": "subflow:2d585252458c7615",
        "wires": [
            [
                "b4b181ef4be0a915"
            ]
        ],
        "x": 530,
        "y": 660,
        "z": "a0a86b2bcc8e6558"
    },
    {
        "finalize": "",
        "func": "const topics = [\n  'shellies/rgbw-1/white/0/set',\n  'shellies/rgbw-1/white/1/set',\n  'shellies/rgbw-2/white/2/set',\n  'shellies/rgbw-2/white/1/set',\n  'shellies/rgbw-2/white/0/set'\n];\n\nlet timeout = 0;\nfor (const topic of topics) {\n  timeout += 400;\n\n  setTimeout(() => node.send({\n    topic,\n    payload: {\n      'turn': 'toggle'\n    }\n  }), timeout);\n}",
        "g": "7e6a568d010b4632",
        "id": "475f75c4c2eb10d8",
        "initialize": "",
        "libs": [],
        "name": "toggle | integrated",
        "noerr": 0,
        "outputs": 1,
        "timeout": 0,
        "type": "function",
        "wires": [
            [
                "e77701baef16ec49"
            ]
        ],
        "x": 790,
        "y": 620,
        "z": "a0a86b2bcc8e6558"
    },
    {
        "env": [
            {
                "name": "name",
                "type": "str",
                "value": "living-room-buttons"
            },
            {
                "name": "button",
                "type": "num",
                "value": "1"
            },
            {
                "name": "buttonId",
                "type": "num",
                "value": "0"
            },
            {
                "name": "id",
                "type": "num",
                "value": "0"
            },
            {
                "name": "input",
                "type": "num",
                "value": "0"
            }
        ],
        "g": "7e6a568d010b4632",
        "id": "f10ee5104e707864",
        "name": "buttons in | living room | 1",
        "type": "subflow:cbef3ce630f61ff7",
        "wires": [
            [
                "913682f3b59ac52b"
            ]
        ],
        "x": 290,
        "y": 700,
        "z": "a0a86b2bcc8e6558"
    },
    {
        "env": [
            {
                "name": "name",
                "type": "str",
                "value": "rgbw-2"
            },
            {
                "name": "relay",
                "type": "num",
                "value": "2"
            }
        ],
        "g": "7e6a568d010b4632",
        "id": "773441761db531ea",
        "name": "rgbw-2 | relay 2",
        "type": "subflow:79a320b1aad5b1c6",
        "wires": [
            [
                "913682f3b59ac52b",
                "e52a4e7bc08c18ca"
            ]
        ],
        "x": 260,
        "y": 620,
        "z": "a0a86b2bcc8e6558"
    },
    {
        "finalize": "",
        "func": "const topics = [\n  'shellies/rgbw-1/white/0/set',\n  'shellies/rgbw-1/white/1/set',\n  'shellies/rgbw-2/white/2/set',\n  'shellies/rgbw-2/white/1/set',\n  'shellies/rgbw-2/white/0/set'\n];\n\nfor (const topic of topics) {\n  node.send({\n    topic,\n    payload: {\n      'brightness': msg.payload.brightness || msg.payload\n    }\n  });\n}",
        "g": "7e6a568d010b4632",
        "id": "1e5fd71a8ed698bf",
        "initialize": "",
        "libs": [],
        "name": "brightness | integrated",
        "noerr": 0,
        "outputs": 1,
        "timeout": 0,
        "type": "function",
        "wires": [
            [
                "e77701baef16ec49"
            ]
        ],
        "x": 820,
        "y": 660,
        "z": "a0a86b2bcc8e6558"
    },
    {
        "finalize": "",
        "func": "if (msg.payload.turn) {\n  return [msg];\n}\n\nelse if (msg.payload.brightness) {\n  return [null, msg];\n}",
        "g": "7e6a568d010b4632",
        "id": "b4b181ef4be0a915",
        "initialize": "",
        "l": false,
        "libs": [],
        "name": "function 2",
        "noerr": 0,
        "outputs": 2,
        "timeout": 0,
        "type": "function",
        "wires": [
            [
                "475f75c4c2eb10d8",
                "44acc098596467ab"
            ],
            [
                "1e5fd71a8ed698bf"
            ]
        ],
        "x": 645,
        "y": 700,
        "z": "a0a86b2bcc8e6558"
    },
    {
        "broker": "872ce2a0d0bada26",
        "datatype": "auto-detect",
        "g": "7e6a568d010b4632",
        "id": "3884ac35ae472890",
        "inputs": 0,
        "name": "mqtt",
        "nl": false,
        "qos": "2",
        "rap": true,
        "rh": 0,
        "topic": "#",
        "type": "mqtt in",
        "wires": [
            [
                "773441761db531ea",
                "c6b94d40a07b7571",
                "f10ee5104e707864"
            ]
        ],
        "x": 90,
        "y": 660,
        "z": "a0a86b2bcc8e6558"
    },
    {
        "g": "7e6a568d010b4632",
        "id": "e52a4e7bc08c18ca",
        "name": "",
        "type": "subflow:5774065fbd82585f",
        "wires": [
            [
                "475f75c4c2eb10d8"
            ],
            [
                "1e5fd71a8ed698bf"
            ]
        ],
        "x": 530,
        "y": 620,
        "z": "a0a86b2bcc8e6558"
    },
    {
        "broker": "872ce2a0d0bada26",
        "contentType": "",
        "correl": "",
        "expiry": "",
        "g": "7e6a568d010b4632",
        "id": "e77701baef16ec49",
        "name": "",
        "qos": "",
        "respTopic": "",
        "retain": "",
        "topic": "",
        "type": "mqtt out",
        "userProps": "",
        "wires": [],
        "x": 1010,
        "y": 620,
        "z": "a0a86b2bcc8e6558"
    },
    {
        "broker": "872ce2a0d0bada26",
        "datatype": "auto-detect",
        "g": "8b798a26c7d6fc01",
        "id": "7d367520dbc9ad84",
        "inputs": 0,
        "name": "mqtt",
        "nl": false,
        "qos": "2",
        "rap": true,
        "rh": 0,
        "topic": "#",
        "type": "mqtt in",
        "wires": [
            [
                "d793a97038cfc19d",
                "f3d5015e09634c2c",
                "4eb63e5365042d67"
            ]
        ],
        "x": 90,
        "y": 840,
        "z": "a0a86b2bcc8e6558"
    },
    {
        "env": [
            {
                "name": "name",
                "type": "str",
                "value": "bedroom"
            }
        ],
        "g": "8b798a26c7d6fc01",
        "id": "d793a97038cfc19d",
        "name": "dimmer in | bedroom",
        "type": "subflow:492ba385940b0a9c",
        "wires": [
            [
                "a13f24cb6365754e",
                "ec652bed47668666"
            ]
        ],
        "x": 280,
        "y": 800,
        "z": "a0a86b2bcc8e6558"
    },
    {
        "env": [
            {
                "name": "name",
                "type": "str",
                "value": "bedroom-buttons-1"
            },
            {
                "name": "button",
                "type": "num",
                "value": "0"
            },
            {
                "name": "buttonId",
                "type": "num",
                "value": "0"
            },
            {
                "name": "id",
                "type": "num",
                "value": "0"
            },
            {
                "name": "input",
                "type": "num",
                "value": "0"
            }
        ],
        "g": "8b798a26c7d6fc01",
        "id": "f3d5015e09634c2c",
        "name": "buttons in | bedroom | 1",
        "type": "subflow:cbef3ce630f61ff7",
        "wires": [
            [
                "a13f24cb6365754e"
            ]
        ],
        "x": 290,
        "y": 840,
        "z": "a0a86b2bcc8e6558"
    },
    {
        "env": [
            {
                "name": "name",
                "type": "str",
                "value": "bedroom-buttons-2"
            },
            {
                "name": "button",
                "type": "num",
                "value": "0"
            },
            {
                "name": "buttonId",
                "type": "num",
                "value": "0"
            },
            {
                "name": "id",
                "type": "num",
                "value": "0"
            },
            {
                "name": "input",
                "type": "num",
                "value": "0"
            }
        ],
        "g": "8b798a26c7d6fc01",
        "id": "4eb63e5365042d67",
        "name": "buttons in | bedroom | 2",
        "type": "subflow:cbef3ce630f61ff7",
        "wires": [
            [
                "a13f24cb6365754e"
            ]
        ],
        "x": 290,
        "y": 880,
        "z": "a0a86b2bcc8e6558"
    },
    {
        "env": [
            {
                "name": "timeout",
                "type": "num",
                "value": "500"
            },
            {
                "name": "step",
                "type": "num",
                "value": "5"
            }
        ],
        "g": "8b798a26c7d6fc01",
        "id": "a13f24cb6365754e",
        "name": "",
        "type": "subflow:2d585252458c7615",
        "wires": [
            [
                "cb54ed4d7ff08f9a"
            ]
        ],
        "x": 530,
        "y": 840,
        "z": "a0a86b2bcc8e6558"
    },
    {
        "env": [
            {
                "name": "name",
                "type": "str",
                "value": "bedroom"
            }
        ],
        "g": "8b798a26c7d6fc01",
        "id": "cb54ed4d7ff08f9a",
        "name": "dimmer out | bedroom",
        "type": "subflow:4c0cd1386899de21",
        "wires": [
            [
                "45203cfbac0c2608"
            ]
        ],
        "x": 740,
        "y": 820,
        "z": "a0a86b2bcc8e6558"
    },
    {
        "broker": "872ce2a0d0bada26",
        "contentType": "",
        "correl": "",
        "expiry": "",
        "g": "8b798a26c7d6fc01",
        "id": "45203cfbac0c2608",
        "name": "",
        "qos": "",
        "respTopic": "",
        "retain": "",
        "topic": "",
        "type": "mqtt out",
        "userProps": "",
        "wires": [],
        "x": 930,
        "y": 820,
        "z": "a0a86b2bcc8e6558"
    },
    {
        "g": "8b798a26c7d6fc01",
        "id": "ec652bed47668666",
        "name": "",
        "type": "subflow:d21607ed4bd9c3e2",
        "wires": [
            [
                "cb54ed4d7ff08f9a"
            ]
        ],
        "x": 510,
        "y": 800,
        "z": "a0a86b2bcc8e6558"
    },
    {
        "broker": "872ce2a0d0bada26",
        "datatype": "auto-detect",
        "g": "593259f5b14bdad3",
        "id": "72d12326ac27d3d0",
        "inputs": 0,
        "name": "mqtt",
        "nl": false,
        "qos": "2",
        "rap": true,
        "rh": 0,
        "topic": "#",
        "type": "mqtt in",
        "wires": [
            [
                "e6f34c6d41f62cb4",
                "5b0a167104357373"
            ]
        ],
        "x": 90,
        "y": 1080,
        "z": "a0a86b2bcc8e6558"
    },
    {
        "env": [
            {
                "name": "name",
                "type": "str",
                "value": "wc-lamp"
            }
        ],
        "g": "593259f5b14bdad3",
        "id": "e6f34c6d41f62cb4",
        "name": "dimmer in | wc lamp",
        "type": "subflow:492ba385940b0a9c",
        "wires": [
            [
                "877b6b22f10fe625"
            ]
        ],
        "x": 280,
        "y": 1060,
        "z": "a0a86b2bcc8e6558"
    },
    {
        "env": [
            {
                "name": "name",
                "type": "str",
                "value": "bathroom"
            }
        ],
        "g": "593259f5b14bdad3",
        "id": "5b0a167104357373",
        "name": "dimmer in | bathroom",
        "type": "subflow:492ba385940b0a9c",
        "wires": [
            [
                "3e90cd523b63f9bf"
            ]
        ],
        "x": 280,
        "y": 1100,
        "z": "a0a86b2bcc8e6558"
    },
    {
        "g": "593259f5b14bdad3",
        "id": "877b6b22f10fe625",
        "name": "",
        "type": "subflow:fbc53d40d3ad022e",
        "wires": [
            [
                "1a28bdf18ec8e12e"
            ]
        ],
        "x": 490,
        "y": 1060,
        "z": "a0a86b2bcc8e6558"
    },
    {
        "g": "593259f5b14bdad3",
        "id": "3e90cd523b63f9bf",
        "name": "",
        "type": "subflow:cc0cff40c0be42c3",
        "wires": [
            [
                "7cce2dea7ab2e57d"
            ]
        ],
        "x": 480,
        "y": 1100,
        "z": "a0a86b2bcc8e6558"
    },
    {
        "env": [
            {
                "name": "name",
                "type": "str",
                "value": "wc-lamp"
            }
        ],
        "g": "593259f5b14bdad3",
        "id": "1a28bdf18ec8e12e",
        "name": "dimmer out | wc lamp",
        "type": "subflow:4c0cd1386899de21",
        "wires": [
            [
                "0ffde8114552b859"
            ]
        ],
        "x": 740,
        "y": 1060,
        "z": "a0a86b2bcc8e6558"
    },
    {
        "broker": "872ce2a0d0bada26",
        "contentType": "",
        "correl": "",
        "expiry": "",
        "g": "593259f5b14bdad3",
        "id": "0ffde8114552b859",
        "name": "",
        "qos": "",
        "respTopic": "",
        "retain": "",
        "topic": "",
        "type": "mqtt out",
        "userProps": "",
        "wires": [],
        "x": 930,
        "y": 1080,
        "z": "a0a86b2bcc8e6558"
    },
    {
        "env": [
            {
                "name": "name",
                "type": "str",
                "value": "bathroom"
            }
        ],
        "g": "593259f5b14bdad3",
        "id": "7cce2dea7ab2e57d",
        "name": "dimmer out | bathroom",
        "type": "subflow:4c0cd1386899de21",
        "wires": [
            [
                "0ffde8114552b859"
            ]
        ],
        "x": 740,
        "y": 1100,
        "z": "a0a86b2bcc8e6558"
    },
    {
        "crontab": "30 23 * * *",
        "g": "593259f5b14bdad3",
        "id": "da34552cedea09aa",
        "name": "ch brightness | night",
        "once": false,
        "onceDelay": 0.1,
        "payload": "{\"brightness\":10}",
        "payloadType": "json",
        "props": [
            {
                "p": "payload"
            }
        ],
        "repeat": "",
        "topic": "",
        "type": "inject",
        "wires": [
            [
                "1a28bdf18ec8e12e"
            ]
        ],
        "x": 460,
        "y": 1020,
        "z": "a0a86b2bcc8e6558"
    },
    {
        "crontab": "30 07 * * *",
        "g": "593259f5b14bdad3",
        "id": "0ed030613fccdd05",
        "name": "ch brightness | day",
        "once": false,
        "onceDelay": 0.1,
        "payload": "{\"brightness\":50}",
        "payloadType": "json",
        "props": [
            {
                "p": "payload"
            }
        ],
        "repeat": "",
        "topic": "",
        "type": "inject",
        "wires": [
            [
                "1a28bdf18ec8e12e"
            ]
        ],
        "x": 460,
        "y": 980,
        "z": "a0a86b2bcc8e6558"
    },
    {
        "broker": "872ce2a0d0bada26",
        "datatype": "auto-detect",
        "g": "475b29c6fe19cc2f",
        "id": "bd622d957a6649e7",
        "inputs": 0,
        "name": "mqtt",
        "nl": false,
        "qos": "2",
        "rap": true,
        "rh": 0,
        "topic": "#",
        "type": "mqtt in",
        "wires": [
            [
                "0e715d3cd4295d30"
            ]
        ],
        "x": 1190,
        "y": 700,
        "z": "a0a86b2bcc8e6558"
    },
    {
        "finalize": "",
        "func": "if (!msg.topic.startsWith('shellies/cabinet')) {\n  return;\n}\n\nif (!msg.topic.endsWith('/events/rpc')) {\n  return;\n}\n\nconst { method } = msg.payload;\n\nif (method !== 'NotifyStatus') {\n  return;\n}\n\nconst { params } = msg.payload;\n\nif (params['switch:0']) {\n  const { output } = params['switch:0'];\n  return {\n    payload: output\n  };\n}",
        "g": "475b29c6fe19cc2f",
        "id": "0e715d3cd4295d30",
        "initialize": "",
        "l": false,
        "libs": [],
        "name": "",
        "noerr": 0,
        "outputs": 1,
        "timeout": 0,
        "type": "function",
        "wires": [
            [
                "3ad3acf5882144a3"
            ]
        ],
        "x": 1275,
        "y": 700,
        "z": "a0a86b2bcc8e6558"
    },
    {
        "className": "",
        "g": "475b29c6fe19cc2f",
        "group": "535b1c0c6989df4e",
        "height": 0,
        "id": "3ad3acf5882144a3",
        "l": false,
        "label": "On / Off",
        "name": "",
        "offcolor": "",
        "officon": "",
        "offvalue": "false",
        "offvalueType": "bool",
        "oncolor": "",
        "onicon": "",
        "onvalue": "true",
        "onvalueType": "bool",
        "order": 0,
        "passthru": false,
        "style": "",
        "topic": "topic",
        "topicType": "msg",
        "type": "ui-switch",
        "width": 0,
        "wires": [
            [
                "44acc098596467ab"
            ]
        ],
        "x": 1325,
        "y": 700,
        "z": "a0a86b2bcc8e6558"
    },
    {
        "finalize": "",
        "func": "return {\n  topic: 'shellies/cabinet/command/switch:0',\n  payload: 'toggle' // msg.payload ? 'on' : 'off'\n};\n",
        "g": "475b29c6fe19cc2f",
        "id": "44acc098596467ab",
        "initialize": "",
        "l": false,
        "libs": [],
        "name": "",
        "noerr": 0,
        "outputs": 1,
        "timeout": 0,
        "type": "function",
        "wires": [
            [
                "690fa293b8ad6c11"
            ]
        ],
        "x": 1375,
        "y": 700,
        "z": "a0a86b2bcc8e6558"
    },
    {
        "broker": "872ce2a0d0bada26",
        "contentType": "",
        "correl": "",
        "expiry": "",
        "g": "475b29c6fe19cc2f",
        "id": "690fa293b8ad6c11",
        "name": "",
        "qos": "",
        "respTopic": "",
        "retain": "",
        "topic": "",
        "type": "mqtt out",
        "userProps": "",
        "wires": [],
        "x": 1470,
        "y": 700,
        "z": "a0a86b2bcc8e6558"
    },
    {
        "broker": "872ce2a0d0bada26",
        "datatype": "auto-detect",
        "g": "c670bbc601d06f66",
        "id": "ac21c02cac1dfbb9",
        "inputs": 0,
        "name": "mqtt",
        "nl": false,
        "qos": "2",
        "rap": true,
        "rh": 0,
        "topic": "#",
        "type": "mqtt in",
        "wires": [
            [
                "6945fa7671640154"
            ]
        ],
        "x": 1110,
        "y": 800,
        "z": "a0a86b2bcc8e6558"
    },
    {
        "env": [
            {
                "name": "name",
                "type": "str",
                "value": "children"
            }
        ],
        "g": "c670bbc601d06f66",
        "id": "6945fa7671640154",
        "name": "dimmer in | children",
        "type": "subflow:492ba385940b0a9c",
        "wires": [
            [
                "99f02fbd5222c74c"
            ]
        ],
        "x": 1270,
        "y": 800,
        "z": "a0a86b2bcc8e6558"
    },
    {
        "env": [
            {
                "name": "name",
                "type": "str",
                "value": "children"
            }
        ],
        "g": "c670bbc601d06f66",
        "id": "7e353c865aeadf04",
        "name": "dimmer out | children",
        "type": "subflow:4c0cd1386899de21",
        "wires": [
            [
                "b6e75cf8831334d2"
            ]
        ],
        "x": 1440,
        "y": 860,
        "z": "a0a86b2bcc8e6558"
    },
    {
        "broker": "872ce2a0d0bada26",
        "contentType": "",
        "correl": "",
        "expiry": "",
        "g": "c670bbc601d06f66",
        "id": "b6e75cf8831334d2",
        "name": "",
        "qos": "",
        "respTopic": "",
        "retain": "",
        "topic": "",
        "type": "mqtt out",
        "userProps": "",
        "wires": [],
        "x": 1610,
        "y": 860,
        "z": "a0a86b2bcc8e6558"
    },
    {
        "g": "c670bbc601d06f66",
        "id": "99f02fbd5222c74c",
        "name": "",
        "type": "subflow:56930ca583a30724",
        "wires": [
            [
                "7e353c865aeadf04"
            ]
        ],
        "x": 1250,
        "y": 860,
        "z": "a0a86b2bcc8e6558"
    },
    {
        "d": true,
        "id": "3656a8cb60e660e0",
        "name": "esp32s3",
        "serial": "4acc30c6d5b7fd08",
        "type": "serial in",
        "wires": [
            [
                "9ebf842d1abe7f7b",
                "e9232fcc25cdb27c"
            ]
        ],
        "x": 120,
        "y": 80,
        "z": "927060cd46690ff4"
    },
    {
        "finalize": "",
        "func": "let last_door_open = context.get('last_door_open') || false;\n\ntry {\n    const { data } = JSON.parse(msg.payload);\n\n    let telegram_msg;\n\n    if (data.door_open !== last_door_open) {\n        telegram_msg = `[Garage] Door is ${data.door_open ? 'open' : 'close'}`;\n    }\n\n    context.set('last_door_open', data.door_open);\n/*\n    if (!data.mac_valid) {\n        telegram_msg = `[Garage] Invalid hmac signature`;\n    }\n\n    if (!data.msg_count_valid) {\n        telegram_msg = `[Garage] Invalid message count`;\n    }\n*/\n    if (telegram_msg) {\n        return {\n            payload: `${telegram_msg}\\n\\n${msg.payload}`\n        };\n    }\n} catch (e) {\n    return {\n        payload: e\n    };\n}",
        "id": "9ebf842d1abe7f7b",
        "initialize": "",
        "l": false,
        "libs": [],
        "name": "",
        "noerr": 0,
        "outputs": 1,
        "timeout": 0,
        "type": "function",
        "wires": [
            [
                "c66c0c21a8ab5325"
            ]
        ],
        "x": 255,
        "y": 80,
        "z": "927060cd46690ff4"
    },
    {
        "bot": "739495fdd028c669",
        "d": true,
        "haserroroutput": false,
        "id": "bb031c2c05891bdd",
        "name": "MQTT Home",
        "outputs": 1,
        "type": "telegram sender",
        "wires": [
            []
        ],
        "x": 570,
        "y": 80,
        "z": "927060cd46690ff4"
    },
    {
        "finalize": "",
        "func": "const type = 'message';\nconst chatId = '5346884135';\n\nreturn {\n    payload: {\n        type,\n        chatId,\n        content: msg.payload\n    }\n};",
        "id": "c66c0c21a8ab5325",
        "initialize": "",
        "l": false,
        "libs": [],
        "name": "",
        "noerr": 0,
        "outputs": 1,
        "timeout": 0,
        "type": "function",
        "wires": [
            [
                "bb031c2c05891bdd"
            ]
        ],
        "x": 455,
        "y": 80,
        "z": "927060cd46690ff4"
    },
    {
        "bytopic": "all",
        "d": true,
        "duration": "1",
        "extend": true,
        "id": "e9232fcc25cdb27c",
        "name": "",
        "op1": "",
        "op1type": "nul",
        "op2": "1 minute exceeded since last sensor report",
        "op2type": "str",
        "outputs": 1,
        "overrideDelay": false,
        "reset": "",
        "topic": "topic",
        "type": "trigger",
        "units": "min",
        "wires": [
            [
                "c66c0c21a8ab5325"
            ]
        ],
        "x": 310,
        "y": 140,
        "z": "927060cd46690ff4"
    }
]